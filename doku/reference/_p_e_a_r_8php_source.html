<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>zimbraControl: classes/PEAR/PEAR.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>classes/PEAR/PEAR.php</h1>  </div>
</div>
<div class="contents">
<a href="_p_e_a_r_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00025"></a><a class="code" href="_p_e_a_r_8php.html#acfe1d5846207d81d3b2882fabbd56840">00025</a> define(<span class="stringliteral">&#39;PEAR_ERROR_RETURN&#39;</span>,     1);
<a name="l00026"></a><a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">00026</a> define(<span class="stringliteral">&#39;PEAR_ERROR_PRINT&#39;</span>,      2);
<a name="l00027"></a><a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">00027</a> define(<span class="stringliteral">&#39;PEAR_ERROR_TRIGGER&#39;</span>,    4);
<a name="l00028"></a><a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">00028</a> define(<span class="stringliteral">&#39;PEAR_ERROR_DIE&#39;</span>,        8);
<a name="l00029"></a><a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">00029</a> define(<span class="stringliteral">&#39;PEAR_ERROR_CALLBACK&#39;</span>,  16);
<a name="l00034"></a><a class="code" href="_p_e_a_r_8php.html#af24ad9b119222367cb61c3081a5aaa75">00034</a> define(<span class="stringliteral">&#39;PEAR_ERROR_EXCEPTION&#39;</span>, 32);
<a name="l00036"></a><a class="code" href="_p_e_a_r_8php.html#adfd76345df24bb19017cdcdca56bd2b0">00036</a> define(<span class="stringliteral">&#39;PEAR_ZE2&#39;</span>, (function_exists(<span class="stringliteral">&#39;version_compare&#39;</span>) &amp;&amp;
<a name="l00037"></a>00037                     version_compare(zend_version(), <span class="stringliteral">&quot;2-dev&quot;</span>, <span class="stringliteral">&quot;ge&quot;</span>)));
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keywordflow">if</span> (substr(PHP_OS, 0, 3) == <span class="stringliteral">&#39;WIN&#39;</span>) {
<a name="l00040"></a>00040     define(<span class="stringliteral">&#39;OS_WINDOWS&#39;</span>, <span class="keyword">true</span>);
<a name="l00041"></a>00041     define(<span class="stringliteral">&#39;OS_UNIX&#39;</span>,    <span class="keyword">false</span>);
<a name="l00042"></a>00042     define(<span class="stringliteral">&#39;PEAR_OS&#39;</span>,    <span class="stringliteral">&#39;Windows&#39;</span>);
<a name="l00043"></a>00043 } <span class="keywordflow">else</span> {
<a name="l00044"></a>00044     define(<span class="stringliteral">&#39;OS_WINDOWS&#39;</span>, <span class="keyword">false</span>);
<a name="l00045"></a>00045     define(<span class="stringliteral">&#39;OS_UNIX&#39;</span>,    <span class="keyword">true</span>);
<a name="l00046"></a>00046     define(<span class="stringliteral">&#39;PEAR_OS&#39;</span>,    <span class="stringliteral">&#39;Unix&#39;</span>); <span class="comment">// blatant assumption</span>
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>]     = PEAR_ERROR_RETURN;
<a name="l00050"></a><a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">00050</a> <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>]  = E_USER_NOTICE;
<a name="l00051"></a><a class="code" href="_p_e_a_r_8php.html#a46e1d062e4e9379133e4b4806e9f4cdd">00051</a> <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_destructor_object_list&#39;</span>] = array();
<a name="l00052"></a><a class="code" href="_p_e_a_r_8php.html#a1e8a8915e879323948ae30d5217c515c">00052</a> <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>]         = array();
<a name="l00053"></a><a class="code" href="_p_e_a_r_8php.html#ae888e544d830e6c8570cd51fd614de27">00053</a> <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_error_handler_stack&#39;</span>]    = array();
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 @ini_set(<span class="stringliteral">&#39;track_errors&#39;</span>, <span class="keyword">true</span>);
<a name="l00056"></a>00056 
<a name="l00087"></a><a class="code" href="class_p_e_a_r.html">00087</a> <span class="keyword">class </span><a class="code" href="class_p_e_a_r.html">PEAR</a>
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089     <span class="comment">// {{{ properties</span>
<a name="l00090"></a>00090 
<a name="l00097"></a><a class="code" href="class_p_e_a_r.html#a666e5fdf2f0915b0ca0ea08ee2c29d2e">00097</a>     var <a class="code" href="class_p_e_a_r.html#a666e5fdf2f0915b0ca0ea08ee2c29d2e">$_debug</a> = <span class="keyword">false</span>;
<a name="l00098"></a>00098 
<a name="l00105"></a><a class="code" href="class_p_e_a_r.html#a74f69a2acfe486eba5db4e948b2b3ecf">00105</a>     var <a class="code" href="class_p_e_a_r.html#a74f69a2acfe486eba5db4e948b2b3ecf">$_default_error_mode</a> = null;
<a name="l00106"></a>00106 
<a name="l00114"></a><a class="code" href="class_p_e_a_r.html#a36f0a42aec842f22c27d776b6ed0c96c">00114</a>     var <a class="code" href="class_p_e_a_r.html#a36f0a42aec842f22c27d776b6ed0c96c">$_default_error_options</a> = null;
<a name="l00115"></a>00115 
<a name="l00123"></a><a class="code" href="class_p_e_a_r.html#a9fca8847ade4af5673825097347765fd">00123</a>     var <a class="code" href="class_p_e_a_r.html#a9fca8847ade4af5673825097347765fd">$_default_error_handler</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00124"></a>00124 
<a name="l00131"></a><a class="code" href="class_p_e_a_r.html#ab64623886b4eafb816040fa38d4ec58c">00131</a>     var <a class="code" href="class_p_e_a_r.html#ab64623886b4eafb816040fa38d4ec58c">$_error_class</a> = <span class="stringliteral">&#39;PEAR_Error&#39;</span>;
<a name="l00132"></a>00132 
<a name="l00139"></a><a class="code" href="class_p_e_a_r.html#ab35a652200ef22fe4930c3b5e1c752c0">00139</a>     var <a class="code" href="class_p_e_a_r.html#ab35a652200ef22fe4930c3b5e1c752c0">$_expected_errors</a> = array();
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <span class="comment">// }}}</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <span class="comment">// {{{ constructor</span>
<a name="l00144"></a>00144 
<a name="l00155"></a><a class="code" href="class_p_e_a_r.html#ab76d2aef23b43b051f5227add98caf98">00155</a>     function <a class="code" href="class_p_e_a_r.html#ab76d2aef23b43b051f5227add98caf98">PEAR</a>($error_class = null)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         $classname = strtolower(get_class($this));
<a name="l00158"></a>00158         <span class="keywordflow">if</span> ($this-&gt;_debug) {
<a name="l00159"></a>00159             print <span class="stringliteral">&quot;PEAR constructor called, class=$classname\n&quot;</span>;
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161         <span class="keywordflow">if</span> ($error_class !== null) {
<a name="l00162"></a>00162             $this-&gt;_error_class = $error_class;
<a name="l00163"></a>00163         }
<a name="l00164"></a>00164         <span class="keywordflow">while</span> ($classname &amp;&amp; strcasecmp($classname, <span class="stringliteral">&quot;pear&quot;</span>)) {
<a name="l00165"></a>00165             $destructor = <span class="stringliteral">&quot;_$classname&quot;</span>;
<a name="l00166"></a>00166             <span class="keywordflow">if</span> (method_exists($this, $destructor)) {
<a name="l00167"></a>00167                 global $_PEAR_destructor_object_list;
<a name="l00168"></a>00168                 $_PEAR_destructor_object_list[] = &amp;$this;
<a name="l00169"></a>00169                 <span class="keywordflow">if</span> (!isset(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_SHUTDOWN_REGISTERED&#39;</span>])) {
<a name="l00170"></a>00170                     register_shutdown_function(<span class="stringliteral">&quot;_PEAR_call_destructors&quot;</span>);
<a name="l00171"></a>00171                     <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_SHUTDOWN_REGISTERED&#39;</span>] = <span class="keyword">true</span>;
<a name="l00172"></a>00172                 }
<a name="l00173"></a>00173                 <span class="keywordflow">break</span>;
<a name="l00174"></a>00174             } <span class="keywordflow">else</span> {
<a name="l00175"></a>00175                 $classname = get_parent_class($classname);
<a name="l00176"></a>00176             }
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178     }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">// }}}</span>
<a name="l00181"></a>00181     <span class="comment">// {{{ destructor</span>
<a name="l00182"></a>00182 
<a name="l00194"></a><a class="code" href="class_p_e_a_r.html#a813fb7675bd4205ccde03ad39aa19ad0">00194</a>     function <a class="code" href="class_p_e_a_r.html#a813fb7675bd4205ccde03ad39aa19ad0">_PEAR</a>() {
<a name="l00195"></a>00195         <span class="keywordflow">if</span> ($this-&gt;_debug) {
<a name="l00196"></a>00196             printf(<span class="stringliteral">&quot;PEAR destructor called, class=%s\n&quot;</span>, strtolower(get_class($this)));
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">// }}}</span>
<a name="l00201"></a>00201     <span class="comment">// {{{ getStaticProperty()</span>
<a name="l00202"></a>00202 
<a name="l00215"></a><a class="code" href="class_p_e_a_r.html#a91e426298a4dece6e3ac8d2d497a4fb0">00215</a>     function &amp;<a class="code" href="class_p_e_a_r.html#a91e426298a4dece6e3ac8d2d497a4fb0">getStaticProperty</a>($class, $var)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217         <span class="keyword">static</span> $properties;
<a name="l00218"></a>00218         <span class="keywordflow">if</span> (!isset($properties[$class])) {
<a name="l00219"></a>00219             $properties[$class] = array();
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (!array_key_exists($var, $properties[$class])) {
<a name="l00223"></a>00223             $properties[$class][$var] = null;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="keywordflow">return</span> $properties[$class][$var];
<a name="l00227"></a>00227     }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="comment">// }}}</span>
<a name="l00230"></a>00230     <span class="comment">// {{{ registerShutdownFunc()</span>
<a name="l00231"></a>00231 
<a name="l00241"></a><a class="code" href="class_p_e_a_r.html#a201e5b60f8b411555a9dd7f0dfe50ca5">00241</a>     function <a class="code" href="class_p_e_a_r.html#a201e5b60f8b411555a9dd7f0dfe50ca5">registerShutdownFunc</a>($func, $args = array())
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243         <span class="comment">// if we are called statically, there is a potential</span>
<a name="l00244"></a>00244         <span class="comment">// that no shutdown func is registered.  Bug #6445</span>
<a name="l00245"></a>00245         <span class="keywordflow">if</span> (!isset(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_SHUTDOWN_REGISTERED&#39;</span>])) {
<a name="l00246"></a>00246             register_shutdown_function(<span class="stringliteral">&quot;_PEAR_call_destructors&quot;</span>);
<a name="l00247"></a>00247             <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_SHUTDOWN_REGISTERED&#39;</span>] = <span class="keyword">true</span>;
<a name="l00248"></a>00248         }
<a name="l00249"></a>00249         <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>][] = array($func, $args);
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <span class="comment">// }}}</span>
<a name="l00253"></a>00253     <span class="comment">// {{{ isError()</span>
<a name="l00254"></a>00254 
<a name="l00266"></a><a class="code" href="class_p_e_a_r.html#a55ae0955466c3970507b122f3f5d1b38">00266</a>     function <a class="code" href="class_p_e_a_r.html#a55ae0955466c3970507b122f3f5d1b38">isError</a>($data, $code = null)
<a name="l00267"></a>00267     {
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (!is_a($data, <span class="stringliteral">&#39;PEAR_Error&#39;</span>)) {
<a name="l00269"></a>00269             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00270"></a>00270         }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">if</span> (is_null($code)) {
<a name="l00273"></a>00273             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00274"></a>00274         } elseif (is_string($code)) {
<a name="l00275"></a>00275             <span class="keywordflow">return</span> $data-&gt;getMessage() == $code;
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         <span class="keywordflow">return</span> $data-&gt;getCode() == $code;
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <span class="comment">// }}}</span>
<a name="l00282"></a>00282     <span class="comment">// {{{ setErrorHandling()</span>
<a name="l00283"></a>00283 
<a name="l00323"></a><a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">00323</a>     function <a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">setErrorHandling</a>($mode = null, $options = null)
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325         <span class="keywordflow">if</span> (isset($this) &amp;&amp; is_a($this, <span class="stringliteral">&#39;PEAR&#39;</span>)) {
<a name="l00326"></a>00326             $setmode     = &amp;$this-&gt;_default_error_mode;
<a name="l00327"></a>00327             $setoptions  = &amp;$this-&gt;_default_error_options;
<a name="l00328"></a>00328         } <span class="keywordflow">else</span> {
<a name="l00329"></a>00329             $setmode     = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>];
<a name="l00330"></a>00330             $setoptions  = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>];
<a name="l00331"></a>00331         }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="keywordflow">switch</span> ($mode) {
<a name="l00334"></a>00334             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#af24ad9b119222367cb61c3081a5aaa75">PEAR_ERROR_EXCEPTION</a>:
<a name="l00335"></a>00335             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#acfe1d5846207d81d3b2882fabbd56840">PEAR_ERROR_RETURN</a>:
<a name="l00336"></a>00336             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">PEAR_ERROR_PRINT</a>:
<a name="l00337"></a>00337             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">PEAR_ERROR_TRIGGER</a>:
<a name="l00338"></a>00338             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">PEAR_ERROR_DIE</a>:
<a name="l00339"></a>00339             <span class="keywordflow">case</span> null:
<a name="l00340"></a>00340                 $setmode = $mode;
<a name="l00341"></a>00341                 $setoptions = $options;
<a name="l00342"></a>00342                 <span class="keywordflow">break</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">PEAR_ERROR_CALLBACK</a>:
<a name="l00345"></a>00345                 $setmode = $mode;
<a name="l00346"></a>00346                 <span class="comment">// class/object method callback</span>
<a name="l00347"></a>00347                 <span class="keywordflow">if</span> (is_callable($options)) {
<a name="l00348"></a>00348                     $setoptions = $options;
<a name="l00349"></a>00349                 } <span class="keywordflow">else</span> {
<a name="l00350"></a>00350                     trigger_error(<span class="stringliteral">&quot;invalid error callback&quot;</span>, E_USER_WARNING);
<a name="l00351"></a>00351                 }
<a name="l00352"></a>00352                 <span class="keywordflow">break</span>;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354             <span class="keywordflow">default</span>:
<a name="l00355"></a>00355                 trigger_error(<span class="stringliteral">&quot;invalid error mode&quot;</span>, E_USER_WARNING);
<a name="l00356"></a>00356                 <span class="keywordflow">break</span>;
<a name="l00357"></a>00357         }
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="comment">// }}}</span>
<a name="l00361"></a>00361     <span class="comment">// {{{ expectError()</span>
<a name="l00362"></a>00362 
<a name="l00378"></a><a class="code" href="class_p_e_a_r.html#ae2bf55e7218f97afc96039d557c7fcae">00378</a>     function <a class="code" href="class_p_e_a_r.html#ae2bf55e7218f97afc96039d557c7fcae">expectError</a>($code = <span class="charliteral">&#39;*&#39;</span>)
<a name="l00379"></a>00379     {
<a name="l00380"></a>00380         <span class="keywordflow">if</span> (is_array($code)) {
<a name="l00381"></a>00381             array_push($this-&gt;_expected_errors, $code);
<a name="l00382"></a>00382         } <span class="keywordflow">else</span> {
<a name="l00383"></a>00383             array_push($this-&gt;_expected_errors, array($code));
<a name="l00384"></a>00384         }
<a name="l00385"></a>00385         <span class="keywordflow">return</span> <span class="keyword">sizeof</span>($this-&gt;_expected_errors);
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="comment">// }}}</span>
<a name="l00389"></a>00389     <span class="comment">// {{{ popExpect()</span>
<a name="l00390"></a>00390 
<a name="l00397"></a><a class="code" href="class_p_e_a_r.html#a80ecc56c9d0937eea105c13edbd741d1">00397</a>     function <a class="code" href="class_p_e_a_r.html#a80ecc56c9d0937eea105c13edbd741d1">popExpect</a>()
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399         <span class="keywordflow">return</span> array_pop($this-&gt;_expected_errors);
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402     <span class="comment">// }}}</span>
<a name="l00403"></a>00403     <span class="comment">// {{{ _checkDelExpect()</span>
<a name="l00404"></a>00404 
<a name="l00413"></a><a class="code" href="class_p_e_a_r.html#ad3c74bbdfad535266bcb1a0d51dd9e4c">00413</a>     function <a class="code" href="class_p_e_a_r.html#ad3c74bbdfad535266bcb1a0d51dd9e4c">_checkDelExpect</a>($error_code)
<a name="l00414"></a>00414     {
<a name="l00415"></a>00415         $deleted = <span class="keyword">false</span>;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417         <span class="keywordflow">foreach</span> ($this-&gt;_expected_errors AS $key =&gt; $error_array) {
<a name="l00418"></a>00418             <span class="keywordflow">if</span> (in_array($error_code, $error_array)) {
<a name="l00419"></a>00419                 unset($this-&gt;_expected_errors[$key][array_search($error_code, $error_array)]);
<a name="l00420"></a>00420                 $deleted = <span class="keyword">true</span>;
<a name="l00421"></a>00421             }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423             <span class="comment">// clean up empty arrays</span>
<a name="l00424"></a>00424             <span class="keywordflow">if</span> (0 == count($this-&gt;_expected_errors[$key])) {
<a name="l00425"></a>00425                 unset($this-&gt;_expected_errors[$key]);
<a name="l00426"></a>00426             }
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428         <span class="keywordflow">return</span> $deleted;
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="comment">// }}}</span>
<a name="l00432"></a>00432     <span class="comment">// {{{ delExpect()</span>
<a name="l00433"></a>00433 
<a name="l00443"></a><a class="code" href="class_p_e_a_r.html#a1bd2019f606582fb368b0ee2969af3a1">00443</a>     function <a class="code" href="class_p_e_a_r.html#a1bd2019f606582fb368b0ee2969af3a1">delExpect</a>($error_code)
<a name="l00444"></a>00444     {
<a name="l00445"></a>00445         $deleted = <span class="keyword">false</span>;
<a name="l00446"></a>00446         <span class="keywordflow">if</span> ((is_array($error_code) &amp;&amp; (0 != count($error_code)))) {
<a name="l00447"></a>00447             <span class="comment">// $error_code is a non-empty array here;</span>
<a name="l00448"></a>00448             <span class="comment">// we walk through it trying to unset all</span>
<a name="l00449"></a>00449             <span class="comment">// values</span>
<a name="l00450"></a>00450             <span class="keywordflow">foreach</span>($error_code as $key =&gt; $error) {
<a name="l00451"></a>00451                 <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_p_e_a_r.html#ad3c74bbdfad535266bcb1a0d51dd9e4c">_checkDelExpect</a>($error)) {
<a name="l00452"></a>00452                     $deleted =  <span class="keyword">true</span>;
<a name="l00453"></a>00453                 } <span class="keywordflow">else</span> {
<a name="l00454"></a>00454                     $deleted = <span class="keyword">false</span>;
<a name="l00455"></a>00455                 }
<a name="l00456"></a>00456             }
<a name="l00457"></a>00457             <span class="keywordflow">return</span> $deleted ? <span class="keyword">true</span> : <a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">PEAR::raiseError</a>(<span class="stringliteral">&quot;The expected error you submitted does not exist&quot;</span>); <span class="comment">// IMPROVE ME</span>
<a name="l00458"></a>00458         } elseif (!empty($error_code)) {
<a name="l00459"></a>00459             <span class="comment">// $error_code comes alone, trying to unset it</span>
<a name="l00460"></a>00460             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="class_p_e_a_r.html#ad3c74bbdfad535266bcb1a0d51dd9e4c">_checkDelExpect</a>($error_code)) {
<a name="l00461"></a>00461                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00462"></a>00462             } <span class="keywordflow">else</span> {
<a name="l00463"></a>00463                 <span class="keywordflow">return</span> <a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">PEAR::raiseError</a>(<span class="stringliteral">&quot;The expected error you submitted does not exist&quot;</span>); <span class="comment">// IMPROVE ME</span>
<a name="l00464"></a>00464             }
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467         <span class="comment">// $error_code is empty</span>
<a name="l00468"></a>00468         <span class="keywordflow">return</span> <a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">PEAR::raiseError</a>(<span class="stringliteral">&quot;The expected error you submitted is empty&quot;</span>); <span class="comment">// IMPROVE ME</span>
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     <span class="comment">// }}}</span>
<a name="l00472"></a>00472     <span class="comment">// {{{ raiseError()</span>
<a name="l00473"></a>00473 
<a name="l00511"></a><a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">00511</a>     function &amp;<a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">raiseError</a>($message = null,
<a name="l00512"></a>00512                          $code = null,
<a name="l00513"></a>00513                          $mode = null,
<a name="l00514"></a>00514                          $options = null,
<a name="l00515"></a>00515                          $userinfo = null,
<a name="l00516"></a>00516                          $error_class = null,
<a name="l00517"></a>00517                          $skipmsg = <span class="keyword">false</span>)
<a name="l00518"></a>00518     {
<a name="l00519"></a>00519         <span class="comment">// The error is yet a PEAR error object</span>
<a name="l00520"></a>00520         <span class="keywordflow">if</span> (is_object($message)) {
<a name="l00521"></a>00521             $code        = $message-&gt;getCode();
<a name="l00522"></a>00522             $userinfo    = $message-&gt;getUserInfo();
<a name="l00523"></a>00523             $error_class = $message-&gt;getType();
<a name="l00524"></a>00524             $message-&gt;error_message_prefix = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00525"></a>00525             $message     = $message-&gt;getMessage();
<a name="l00526"></a>00526         }
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="keywordflow">if</span> (isset($this) &amp;&amp; isset($this-&gt;_expected_errors) &amp;&amp; <span class="keyword">sizeof</span>($this-&gt;_expected_errors) &gt; 0 &amp;&amp; <span class="keyword">sizeof</span>($exp = end($this-&gt;_expected_errors))) {
<a name="l00529"></a>00529             <span class="keywordflow">if</span> ($exp[0] == <span class="stringliteral">&quot;*&quot;</span> ||
<a name="l00530"></a>00530                 (is_int(reset($exp)) &amp;&amp; in_array($code, $exp)) ||
<a name="l00531"></a>00531                 (is_string(reset($exp)) &amp;&amp; in_array($message, $exp))) {
<a name="l00532"></a>00532                 $mode = PEAR_ERROR_RETURN;
<a name="l00533"></a>00533             }
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         <span class="comment">// No mode given, try global ones</span>
<a name="l00537"></a>00537         <span class="keywordflow">if</span> ($mode === null) {
<a name="l00538"></a>00538             <span class="comment">// Class error handler</span>
<a name="l00539"></a>00539             <span class="keywordflow">if</span> (isset($this) &amp;&amp; isset($this-&gt;_default_error_mode)) {
<a name="l00540"></a>00540                 $mode    = $this-&gt;_default_error_mode;
<a name="l00541"></a>00541                 $options = $this-&gt;_default_error_options;
<a name="l00542"></a>00542             <span class="comment">// Global error handler</span>
<a name="l00543"></a>00543             } elseif (isset(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>])) {
<a name="l00544"></a>00544                 $mode    = <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>];
<a name="l00545"></a>00545                 $options = <a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>];
<a name="l00546"></a>00546             }
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549         <span class="keywordflow">if</span> ($error_class !== null) {
<a name="l00550"></a>00550             $ec = $error_class;
<a name="l00551"></a>00551         } elseif (isset($this) &amp;&amp; isset($this-&gt;_error_class)) {
<a name="l00552"></a>00552             $ec = $this-&gt;_error_class;
<a name="l00553"></a>00553         } <span class="keywordflow">else</span> {
<a name="l00554"></a>00554             $ec = <span class="stringliteral">&#39;PEAR_Error&#39;</span>;
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <span class="keywordflow">if</span> (intval(PHP_VERSION) &lt; 5) {
<a name="l00558"></a>00558             <span class="comment">// little non-eval hack to fix bug #12147</span>
<a name="l00559"></a>00559             include <span class="stringliteral">&#39;PEAR/FixPHP5PEARWarnings.php&#39;</span>;
<a name="l00560"></a>00560             <span class="keywordflow">return</span> $a;
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563         <span class="keywordflow">if</span> ($skipmsg) {
<a name="l00564"></a>00564             $a = <span class="keyword">new</span> $ec($code, $mode, $options, $userinfo);
<a name="l00565"></a>00565         } <span class="keywordflow">else</span> {
<a name="l00566"></a>00566             $a = <span class="keyword">new</span> $ec($message, $code, $mode, $options, $userinfo);
<a name="l00567"></a>00567         }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569         <span class="keywordflow">return</span> $a;
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="comment">// }}}</span>
<a name="l00573"></a>00573     <span class="comment">// {{{ throwError()</span>
<a name="l00574"></a>00574 
<a name="l00582"></a><a class="code" href="class_p_e_a_r.html#a968630eb3f8e961fbba040543764a0eb">00582</a>     function &amp;<a class="code" href="class_p_e_a_r.html#a968630eb3f8e961fbba040543764a0eb">throwError</a>($message = null,
<a name="l00583"></a>00583                          $code = null,
<a name="l00584"></a>00584                          $userinfo = null)
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586         <span class="keywordflow">if</span> (isset($this) &amp;&amp; is_a($this, <span class="stringliteral">&#39;PEAR&#39;</span>)) {
<a name="l00587"></a>00587             $a = &amp;$this-&gt;<a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">raiseError</a>($message, $code, null, null, $userinfo);
<a name="l00588"></a>00588             <span class="keywordflow">return</span> $a;
<a name="l00589"></a>00589         }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591         $a = &amp;<a class="code" href="class_p_e_a_r.html#a0ab3d4f101ecbf44db325ea332943640">PEAR::raiseError</a>($message, $code, null, null, $userinfo);
<a name="l00592"></a>00592         <span class="keywordflow">return</span> $a;
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="comment">// }}}</span>
<a name="l00596"></a><a class="code" href="class_p_e_a_r.html#ac1e6f77822239c0911b3376918a3211d">00596</a>     function <a class="code" href="class_p_e_a_r.html#ac1e6f77822239c0911b3376918a3211d">staticPushErrorHandling</a>($mode, $options = null)
<a name="l00597"></a>00597     {
<a name="l00598"></a>00598         $stack = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_error_handler_stack&#39;</span>];
<a name="l00599"></a>00599         $def_mode    = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>];
<a name="l00600"></a>00600         $def_options = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>];
<a name="l00601"></a>00601         $stack[] = array($def_mode, $def_options);
<a name="l00602"></a>00602         <span class="keywordflow">switch</span> ($mode) {
<a name="l00603"></a>00603             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#af24ad9b119222367cb61c3081a5aaa75">PEAR_ERROR_EXCEPTION</a>:
<a name="l00604"></a>00604             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#acfe1d5846207d81d3b2882fabbd56840">PEAR_ERROR_RETURN</a>:
<a name="l00605"></a>00605             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">PEAR_ERROR_PRINT</a>:
<a name="l00606"></a>00606             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">PEAR_ERROR_TRIGGER</a>:
<a name="l00607"></a>00607             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">PEAR_ERROR_DIE</a>:
<a name="l00608"></a>00608             <span class="keywordflow">case</span> null:
<a name="l00609"></a>00609                 $def_mode = $mode;
<a name="l00610"></a>00610                 $def_options = $options;
<a name="l00611"></a>00611                 <span class="keywordflow">break</span>;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">PEAR_ERROR_CALLBACK</a>:
<a name="l00614"></a>00614                 $def_mode = $mode;
<a name="l00615"></a>00615                 <span class="comment">// class/object method callback</span>
<a name="l00616"></a>00616                 <span class="keywordflow">if</span> (is_callable($options)) {
<a name="l00617"></a>00617                     $def_options = $options;
<a name="l00618"></a>00618                 } <span class="keywordflow">else</span> {
<a name="l00619"></a>00619                     trigger_error(<span class="stringliteral">&quot;invalid error callback&quot;</span>, E_USER_WARNING);
<a name="l00620"></a>00620                 }
<a name="l00621"></a>00621                 <span class="keywordflow">break</span>;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623             <span class="keywordflow">default</span>:
<a name="l00624"></a>00624                 trigger_error(<span class="stringliteral">&quot;invalid error mode&quot;</span>, E_USER_WARNING);
<a name="l00625"></a>00625                 <span class="keywordflow">break</span>;
<a name="l00626"></a>00626         }
<a name="l00627"></a>00627         $stack[] = array($mode, $options);
<a name="l00628"></a>00628         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00629"></a>00629     }
<a name="l00630"></a>00630 
<a name="l00631"></a><a class="code" href="class_p_e_a_r.html#a4c4c51f83508da3854ea27425515dda7">00631</a>     function <a class="code" href="class_p_e_a_r.html#a4c4c51f83508da3854ea27425515dda7">staticPopErrorHandling</a>()
<a name="l00632"></a>00632     {
<a name="l00633"></a>00633         $stack = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_error_handler_stack&#39;</span>];
<a name="l00634"></a>00634         $setmode     = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>];
<a name="l00635"></a>00635         $setoptions  = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>];
<a name="l00636"></a>00636         array_pop($stack);
<a name="l00637"></a>00637         list($mode, $options) = $stack[<span class="keyword">sizeof</span>($stack) - 1];
<a name="l00638"></a>00638         array_pop($stack);
<a name="l00639"></a>00639         <span class="keywordflow">switch</span> ($mode) {
<a name="l00640"></a>00640             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#af24ad9b119222367cb61c3081a5aaa75">PEAR_ERROR_EXCEPTION</a>:
<a name="l00641"></a>00641             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#acfe1d5846207d81d3b2882fabbd56840">PEAR_ERROR_RETURN</a>:
<a name="l00642"></a>00642             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">PEAR_ERROR_PRINT</a>:
<a name="l00643"></a>00643             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">PEAR_ERROR_TRIGGER</a>:
<a name="l00644"></a>00644             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">PEAR_ERROR_DIE</a>:
<a name="l00645"></a>00645             <span class="keywordflow">case</span> null:
<a name="l00646"></a>00646                 $setmode = $mode;
<a name="l00647"></a>00647                 $setoptions = $options;
<a name="l00648"></a>00648                 <span class="keywordflow">break</span>;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650             <span class="keywordflow">case</span> <a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">PEAR_ERROR_CALLBACK</a>:
<a name="l00651"></a>00651                 $setmode = $mode;
<a name="l00652"></a>00652                 <span class="comment">// class/object method callback</span>
<a name="l00653"></a>00653                 <span class="keywordflow">if</span> (is_callable($options)) {
<a name="l00654"></a>00654                     $setoptions = $options;
<a name="l00655"></a>00655                 } <span class="keywordflow">else</span> {
<a name="l00656"></a>00656                     trigger_error(<span class="stringliteral">&quot;invalid error callback&quot;</span>, E_USER_WARNING);
<a name="l00657"></a>00657                 }
<a name="l00658"></a>00658                 <span class="keywordflow">break</span>;
<a name="l00659"></a>00659 
<a name="l00660"></a>00660             <span class="keywordflow">default</span>:
<a name="l00661"></a>00661                 trigger_error(<span class="stringliteral">&quot;invalid error mode&quot;</span>, E_USER_WARNING);
<a name="l00662"></a>00662                 <span class="keywordflow">break</span>;
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667     <span class="comment">// {{{ pushErrorHandling()</span>
<a name="l00668"></a>00668 
<a name="l00681"></a><a class="code" href="class_p_e_a_r.html#a9d9d03ad41639dd7554d84cfc46c23ae">00681</a>     function <a class="code" href="class_p_e_a_r.html#a9d9d03ad41639dd7554d84cfc46c23ae">pushErrorHandling</a>($mode, $options = null)
<a name="l00682"></a>00682     {
<a name="l00683"></a>00683         $stack = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_error_handler_stack&#39;</span>];
<a name="l00684"></a>00684         <span class="keywordflow">if</span> (isset($this) &amp;&amp; is_a($this, <span class="stringliteral">&#39;PEAR&#39;</span>)) {
<a name="l00685"></a>00685             $def_mode    = &amp;$this-&gt;_default_error_mode;
<a name="l00686"></a>00686             $def_options = &amp;$this-&gt;_default_error_options;
<a name="l00687"></a>00687         } <span class="keywordflow">else</span> {
<a name="l00688"></a>00688             $def_mode    = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_mode&#39;</span>];
<a name="l00689"></a>00689             $def_options = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_default_error_options&#39;</span>];
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691         $stack[] = array($def_mode, $def_options);
<a name="l00692"></a>00692 
<a name="l00693"></a>00693         <span class="keywordflow">if</span> (isset($this) &amp;&amp; is_a($this, <span class="stringliteral">&#39;PEAR&#39;</span>)) {
<a name="l00694"></a>00694             $this-&gt;<a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">setErrorHandling</a>($mode, $options);
<a name="l00695"></a>00695         } <span class="keywordflow">else</span> {
<a name="l00696"></a>00696             <a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">PEAR::setErrorHandling</a>($mode, $options);
<a name="l00697"></a>00697         }
<a name="l00698"></a>00698         $stack[] = array($mode, $options);
<a name="l00699"></a>00699         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00700"></a>00700     }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     <span class="comment">// }}}</span>
<a name="l00703"></a>00703     <span class="comment">// {{{ popErrorHandling()</span>
<a name="l00704"></a>00704 
<a name="l00712"></a><a class="code" href="class_p_e_a_r.html#a5cd416f080e6e3dc119715296fa207ad">00712</a>     function <a class="code" href="class_p_e_a_r.html#a5cd416f080e6e3dc119715296fa207ad">popErrorHandling</a>()
<a name="l00713"></a>00713     {
<a name="l00714"></a>00714         $stack = &amp;<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_error_handler_stack&#39;</span>];
<a name="l00715"></a>00715         array_pop($stack);
<a name="l00716"></a>00716         list($mode, $options) = $stack[<span class="keyword">sizeof</span>($stack) - 1];
<a name="l00717"></a>00717         array_pop($stack);
<a name="l00718"></a>00718         <span class="keywordflow">if</span> (isset($this) &amp;&amp; is_a($this, <span class="stringliteral">&#39;PEAR&#39;</span>)) {
<a name="l00719"></a>00719             $this-&gt;<a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">setErrorHandling</a>($mode, $options);
<a name="l00720"></a>00720         } <span class="keywordflow">else</span> {
<a name="l00721"></a>00721             <a class="code" href="class_p_e_a_r.html#abf8a6ab1c2e5774183d1f78aaf7f94f9">PEAR::setErrorHandling</a>($mode, $options);
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726     <span class="comment">// }}}</span>
<a name="l00727"></a>00727     <span class="comment">// {{{ loadExtension()</span>
<a name="l00728"></a>00728 
<a name="l00736"></a><a class="code" href="class_p_e_a_r.html#a4eecf4561755a1f3983ec1cff23f2ab4">00736</a>     function <a class="code" href="class_p_e_a_r.html#a4eecf4561755a1f3983ec1cff23f2ab4">loadExtension</a>($ext)
<a name="l00737"></a>00737     {
<a name="l00738"></a>00738         <span class="keywordflow">if</span> (!extension_loaded($ext)) {
<a name="l00739"></a>00739             <span class="comment">// if either returns true dl() will produce a FATAL error, stop that</span>
<a name="l00740"></a>00740             <span class="keywordflow">if</span> ((ini_get(<span class="stringliteral">&#39;enable_dl&#39;</span>) != 1) || (ini_get(<span class="stringliteral">&#39;safe_mode&#39;</span>) == 1)) {
<a name="l00741"></a>00741                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00742"></a>00742             }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744             <span class="keywordflow">if</span> (OS_WINDOWS) {
<a name="l00745"></a>00745                 $suffix = <span class="stringliteral">&#39;.dll&#39;</span>;
<a name="l00746"></a>00746             } elseif (PHP_OS == <span class="stringliteral">&#39;HP-UX&#39;</span>) {
<a name="l00747"></a>00747                 $suffix = <span class="stringliteral">&#39;.sl&#39;</span>;
<a name="l00748"></a>00748             } elseif (PHP_OS == <span class="stringliteral">&#39;AIX&#39;</span>) {
<a name="l00749"></a>00749                 $suffix = <span class="stringliteral">&#39;.a&#39;</span>;
<a name="l00750"></a>00750             } elseif (PHP_OS == <span class="stringliteral">&#39;OSX&#39;</span>) {
<a name="l00751"></a>00751                 $suffix = <span class="stringliteral">&#39;.bundle&#39;</span>;
<a name="l00752"></a>00752             } <span class="keywordflow">else</span> {
<a name="l00753"></a>00753                 $suffix = <span class="stringliteral">&#39;.so&#39;</span>;
<a name="l00754"></a>00754             }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756             <span class="keywordflow">return</span> @dl(<span class="stringliteral">&#39;php_&#39;</span>.$ext.$suffix) || @dl($ext.$suffix);
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <span class="comment">// }}}</span>
<a name="l00763"></a>00763 }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <span class="keywordflow">if</span> (<a class="code" href="_p_e_a_r_8php.html#adfd76345df24bb19017cdcdca56bd2b0">PEAR_ZE2</a>) {
<a name="l00766"></a>00766     include_once <span class="stringliteral">&#39;PEAR5.php&#39;</span>;
<a name="l00767"></a>00767 }
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 <span class="comment">// {{{ _PEAR_call_destructors()</span>
<a name="l00770"></a>00770 
<a name="l00771"></a><a class="code" href="_p_e_a_r_8php.html#af9e3621e2aa4f0546c04ab675e5efca6">00771</a> function <a class="code" href="_p_e_a_r_8php.html#af9e3621e2aa4f0546c04ab675e5efca6">_PEAR_call_destructors</a>()
<a name="l00772"></a>00772 {
<a name="l00773"></a>00773     global $_PEAR_destructor_object_list;
<a name="l00774"></a>00774     <span class="keywordflow">if</span> (is_array($_PEAR_destructor_object_list) &amp;&amp;
<a name="l00775"></a>00775         <span class="keyword">sizeof</span>($_PEAR_destructor_object_list))
<a name="l00776"></a>00776     {
<a name="l00777"></a>00777         reset($_PEAR_destructor_object_list);
<a name="l00778"></a>00778         <span class="keywordflow">if</span> (<a class="code" href="_p_e_a_r_8php.html#adfd76345df24bb19017cdcdca56bd2b0">PEAR_ZE2</a>) {
<a name="l00779"></a>00779             $destructLifoExists = <a class="code" href="class_p_e_a_r5.html#a0b4aa1c18ab0c9ae0d1f0e5bc4cc1fc0">PEAR5::getStaticProperty</a>(<span class="stringliteral">&#39;PEAR&#39;</span>, <span class="stringliteral">&#39;destructlifo&#39;</span>);
<a name="l00780"></a>00780         } <span class="keywordflow">else</span> {
<a name="l00781"></a>00781             $destructLifoExists = <a class="code" href="class_p_e_a_r.html#a91e426298a4dece6e3ac8d2d497a4fb0">PEAR::getStaticProperty</a>(<span class="stringliteral">&#39;PEAR&#39;</span>, <span class="stringliteral">&#39;destructlifo&#39;</span>);
<a name="l00782"></a>00782         }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         <span class="keywordflow">if</span> ($destructLifoExists) {
<a name="l00785"></a>00785             $_PEAR_destructor_object_list = array_reverse($_PEAR_destructor_object_list);
<a name="l00786"></a>00786         }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788         <span class="keywordflow">while</span> (list($k, $objref) = each($_PEAR_destructor_object_list)) {
<a name="l00789"></a>00789             $classname = get_class($objref);
<a name="l00790"></a>00790             <span class="keywordflow">while</span> ($classname) {
<a name="l00791"></a>00791                 $destructor = <span class="stringliteral">&quot;_$classname&quot;</span>;
<a name="l00792"></a>00792                 <span class="keywordflow">if</span> (method_exists($objref, $destructor)) {
<a name="l00793"></a>00793                     $objref-&gt;$destructor();
<a name="l00794"></a>00794                     <span class="keywordflow">break</span>;
<a name="l00795"></a>00795                 } <span class="keywordflow">else</span> {
<a name="l00796"></a>00796                     $classname = get_parent_class($classname);
<a name="l00797"></a>00797                 }
<a name="l00798"></a>00798             }
<a name="l00799"></a>00799         }
<a name="l00800"></a>00800         <span class="comment">// Empty the object list to ensure that destructors are</span>
<a name="l00801"></a>00801         <span class="comment">// not called more than once.</span>
<a name="l00802"></a>00802         $_PEAR_destructor_object_list = array();
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     <span class="comment">// Now call the shutdown functions</span>
<a name="l00806"></a>00806     <span class="keywordflow">if</span> (isset(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>]) AND is_array(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>]) AND !empty(<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>])) {
<a name="l00807"></a>00807         <span class="keywordflow">foreach</span> (<a class="code" href="_p_e_a_r_8php.html#a9a627cdd7a06f69e65a763b541b3540c">$GLOBALS</a>[<span class="stringliteral">&#39;_PEAR_shutdown_funcs&#39;</span>] as $value) {
<a name="l00808"></a>00808             call_user_func_array($value[0], $value[1]);
<a name="l00809"></a>00809         }
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 <span class="comment">// }}}</span>
<a name="l00831"></a><a class="code" href="class_p_e_a_r___error.html">00831</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_p_e_a_r___error.html">PEAR_Error</a>
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833     <span class="comment">// {{{ properties</span>
<a name="l00834"></a>00834 
<a name="l00835"></a><a class="code" href="class_p_e_a_r___error.html#a8b5856f5d559a15bdd55e9021d6cb6e0">00835</a>     var <a class="code" href="class_p_e_a_r___error.html#a8b5856f5d559a15bdd55e9021d6cb6e0">$error_message_prefix</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00836"></a><a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">00836</a>     var <a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>                 = PEAR_ERROR_RETURN;
<a name="l00837"></a><a class="code" href="class_p_e_a_r___error.html#abd32cc82c6a3f79491987de36ad580ca">00837</a>     var <a class="code" href="class_p_e_a_r___error.html#abd32cc82c6a3f79491987de36ad580ca">$level</a>                = E_USER_NOTICE;
<a name="l00838"></a><a class="code" href="class_p_e_a_r___error.html#a7949acdaecc70b9f035c12a7069db132">00838</a>     var <a class="code" href="class_p_e_a_r___error.html#a7949acdaecc70b9f035c12a7069db132">$code</a>                 = -1;
<a name="l00839"></a><a class="code" href="class_p_e_a_r___error.html#abf17cb2dba2ed17cb28aa5f37deb5293">00839</a>     var <a class="code" href="class_p_e_a_r___error.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>              = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00840"></a><a class="code" href="class_p_e_a_r___error.html#ad7307d3cba8bcaeac7cffd5ff9a94aa0">00840</a>     var <a class="code" href="class_p_e_a_r___error.html#ad7307d3cba8bcaeac7cffd5ff9a94aa0">$userinfo</a>             = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00841"></a><a class="code" href="class_p_e_a_r___error.html#acadbfd28b1f67d24268b68ccf9715dcd">00841</a>     var <a class="code" href="class_p_e_a_r___error.html#acadbfd28b1f67d24268b68ccf9715dcd">$backtrace</a>            = null;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843     <span class="comment">// }}}</span>
<a name="l00844"></a>00844     <span class="comment">// {{{ constructor</span>
<a name="l00845"></a>00845 
<a name="l00866"></a><a class="code" href="class_p_e_a_r___error.html#a5319a4e116f32f766325aa5ade5f6014">00866</a>     function <a class="code" href="class_p_e_a_r___error.html#a5319a4e116f32f766325aa5ade5f6014">PEAR_Error</a>(<a class="code" href="class_p_e_a_r___error.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a> = <span class="stringliteral">&#39;unknown error&#39;</span>, <a class="code" href="class_p_e_a_r___error.html#a7949acdaecc70b9f035c12a7069db132">$code</a> = null,
<a name="l00867"></a>00867                         <a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = null, $options = null, <a class="code" href="class_p_e_a_r___error.html#ad7307d3cba8bcaeac7cffd5ff9a94aa0">$userinfo</a> = null)
<a name="l00868"></a>00868     {
<a name="l00869"></a>00869         <span class="keywordflow">if</span> (<a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> === null) {
<a name="l00870"></a>00870             <a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = PEAR_ERROR_RETURN;
<a name="l00871"></a>00871         }
<a name="l00872"></a>00872         $this-&gt;message   = <a class="code" href="class_p_e_a_r___error.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>;
<a name="l00873"></a>00873         $this-&gt;code      = <a class="code" href="class_p_e_a_r___error.html#a7949acdaecc70b9f035c12a7069db132">$code</a>;
<a name="l00874"></a>00874         $this-&gt;mode      = <a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>;
<a name="l00875"></a>00875         $this-&gt;userinfo  = <a class="code" href="class_p_e_a_r___error.html#ad7307d3cba8bcaeac7cffd5ff9a94aa0">$userinfo</a>;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877         <span class="keywordflow">if</span> (<a class="code" href="_p_e_a_r_8php.html#adfd76345df24bb19017cdcdca56bd2b0">PEAR_ZE2</a>) {
<a name="l00878"></a>00878             $skiptrace = <a class="code" href="class_p_e_a_r5.html#a0b4aa1c18ab0c9ae0d1f0e5bc4cc1fc0">PEAR5::getStaticProperty</a>(<span class="stringliteral">&#39;PEAR_Error&#39;</span>, <span class="stringliteral">&#39;skiptrace&#39;</span>);
<a name="l00879"></a>00879         } <span class="keywordflow">else</span> {
<a name="l00880"></a>00880             $skiptrace = <a class="code" href="class_p_e_a_r.html#a91e426298a4dece6e3ac8d2d497a4fb0">PEAR::getStaticProperty</a>(<span class="stringliteral">&#39;PEAR_Error&#39;</span>, <span class="stringliteral">&#39;skiptrace&#39;</span>);
<a name="l00881"></a>00881         }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         <span class="keywordflow">if</span> (!$skiptrace) {
<a name="l00884"></a>00884             $this-&gt;backtrace = debug_backtrace();
<a name="l00885"></a>00885             <span class="keywordflow">if</span> (isset($this-&gt;backtrace[0]) &amp;&amp; isset($this-&gt;backtrace[0][<span class="stringliteral">&#39;object&#39;</span>])) {
<a name="l00886"></a>00886                 unset($this-&gt;backtrace[0][<span class="stringliteral">&#39;object&#39;</span>]);
<a name="l00887"></a>00887             }
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">if</span> (<a class="code" href="class_p_e_a_r___error.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> &amp; <a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">PEAR_ERROR_CALLBACK</a>) {
<a name="l00891"></a>00891             $this-&gt;level = E_USER_NOTICE;
<a name="l00892"></a>00892             $this-&gt;callback = $options;
<a name="l00893"></a>00893         } <span class="keywordflow">else</span> {
<a name="l00894"></a>00894             <span class="keywordflow">if</span> ($options === null) {
<a name="l00895"></a>00895                 $options = E_USER_NOTICE;
<a name="l00896"></a>00896             }
<a name="l00897"></a>00897 
<a name="l00898"></a>00898             $this-&gt;level = $options;
<a name="l00899"></a>00899             $this-&gt;callback = null;
<a name="l00900"></a>00900         }
<a name="l00901"></a>00901 
<a name="l00902"></a>00902         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">PEAR_ERROR_PRINT</a>) {
<a name="l00903"></a>00903             <span class="keywordflow">if</span> (is_null($options) || is_int($options)) {
<a name="l00904"></a>00904                 $format = <span class="stringliteral">&quot;%s&quot;</span>;
<a name="l00905"></a>00905             } <span class="keywordflow">else</span> {
<a name="l00906"></a>00906                 $format = $options;
<a name="l00907"></a>00907             }
<a name="l00908"></a>00908 
<a name="l00909"></a>00909             printf($format, $this-&gt;<a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">getMessage</a>());
<a name="l00910"></a>00910         }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">PEAR_ERROR_TRIGGER</a>) {
<a name="l00913"></a>00913             trigger_error($this-&gt;<a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">getMessage</a>(), $this-&gt;level);
<a name="l00914"></a>00914         }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">PEAR_ERROR_DIE</a>) {
<a name="l00917"></a>00917             $msg = $this-&gt;<a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">getMessage</a>();
<a name="l00918"></a>00918             <span class="keywordflow">if</span> (is_null($options) || is_int($options)) {
<a name="l00919"></a>00919                 $format = <span class="stringliteral">&quot;%s&quot;</span>;
<a name="l00920"></a>00920                 <span class="keywordflow">if</span> (substr($msg, -1) != <span class="stringliteral">&quot;\n&quot;</span>) {
<a name="l00921"></a>00921                     $msg .= <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00922"></a>00922                 }
<a name="l00923"></a>00923             } <span class="keywordflow">else</span> {
<a name="l00924"></a>00924                 $format = $options;
<a name="l00925"></a>00925             }
<a name="l00926"></a>00926             die(sprintf($format, $msg));
<a name="l00927"></a>00927         }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929         <span class="keywordflow">if</span> ($this-&gt;mode &amp; PEAR_ERROR_CALLBACK) {
<a name="l00930"></a>00930             <span class="keywordflow">if</span> (is_callable($this-&gt;callback)) {
<a name="l00931"></a>00931                 call_user_func($this-&gt;callback, $this);
<a name="l00932"></a>00932             }
<a name="l00933"></a>00933         }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#af24ad9b119222367cb61c3081a5aaa75">PEAR_ERROR_EXCEPTION</a>) {
<a name="l00936"></a>00936             trigger_error(<span class="stringliteral">&quot;PEAR_ERROR_EXCEPTION is obsolete, use class PEAR_Exception for exceptions&quot;</span>, E_USER_WARNING);
<a name="l00937"></a>00937             eval(<span class="stringliteral">&#39;$e = new Exception($this-&gt;message, $this-&gt;code);throw($e);&#39;</span>);
<a name="l00938"></a>00938         }
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941     <span class="comment">// }}}</span>
<a name="l00942"></a>00942     <span class="comment">// {{{ getMode()</span>
<a name="l00943"></a>00943 
<a name="l00950"></a><a class="code" href="class_p_e_a_r___error.html#a6575c27b4e37901c864476375ec9369e">00950</a>     function <a class="code" href="class_p_e_a_r___error.html#a6575c27b4e37901c864476375ec9369e">getMode</a>() {
<a name="l00951"></a>00951         <span class="keywordflow">return</span> $this-&gt;mode;
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <span class="comment">// }}}</span>
<a name="l00955"></a>00955     <span class="comment">// {{{ getCallback()</span>
<a name="l00956"></a>00956 
<a name="l00963"></a><a class="code" href="class_p_e_a_r___error.html#acbd215c5bf109a1fe6ecd5dca0b86fda">00963</a>     function <a class="code" href="class_p_e_a_r___error.html#acbd215c5bf109a1fe6ecd5dca0b86fda">getCallback</a>() {
<a name="l00964"></a>00964         <span class="keywordflow">return</span> $this-&gt;callback;
<a name="l00965"></a>00965     }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967     <span class="comment">// }}}</span>
<a name="l00968"></a>00968     <span class="comment">// {{{ getMessage()</span>
<a name="l00969"></a>00969 
<a name="l00970"></a>00970 
<a name="l00977"></a><a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">00977</a>     function <a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">getMessage</a>()
<a name="l00978"></a>00978     {
<a name="l00979"></a>00979         <span class="keywordflow">return</span> ($this-&gt;error_message_prefix . $this-&gt;message);
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 
<a name="l00983"></a>00983     <span class="comment">// }}}</span>
<a name="l00984"></a>00984     <span class="comment">// {{{ getCode()</span>
<a name="l00985"></a>00985 
<a name="l00992"></a><a class="code" href="class_p_e_a_r___error.html#ab5e24da53b4a0d0848b18c1e832f47ff">00992</a>      function <a class="code" href="class_p_e_a_r___error.html#ab5e24da53b4a0d0848b18c1e832f47ff">getCode</a>()
<a name="l00993"></a>00993      {
<a name="l00994"></a>00994         <span class="keywordflow">return</span> $this-&gt;code;
<a name="l00995"></a>00995      }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997     <span class="comment">// }}}</span>
<a name="l00998"></a>00998     <span class="comment">// {{{ getType()</span>
<a name="l00999"></a>00999 
<a name="l01006"></a><a class="code" href="class_p_e_a_r___error.html#a830b5c75df72b32396701bc563fbe3c7">01006</a>     function <a class="code" href="class_p_e_a_r___error.html#a830b5c75df72b32396701bc563fbe3c7">getType</a>()
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008         <span class="keywordflow">return</span> get_class($this);
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011     <span class="comment">// }}}</span>
<a name="l01012"></a>01012     <span class="comment">// {{{ getUserInfo()</span>
<a name="l01013"></a>01013 
<a name="l01020"></a><a class="code" href="class_p_e_a_r___error.html#a7e7999c3a04f08ffcc5e237fd28a6bc7">01020</a>     function <a class="code" href="class_p_e_a_r___error.html#a7e7999c3a04f08ffcc5e237fd28a6bc7">getUserInfo</a>()
<a name="l01021"></a>01021     {
<a name="l01022"></a>01022         <span class="keywordflow">return</span> $this-&gt;userinfo;
<a name="l01023"></a>01023     }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025     <span class="comment">// }}}</span>
<a name="l01026"></a>01026     <span class="comment">// {{{ getDebugInfo()</span>
<a name="l01027"></a>01027 
<a name="l01034"></a><a class="code" href="class_p_e_a_r___error.html#abd0ecb0136f4228db2bd963bfc1e20d7">01034</a>     function <a class="code" href="class_p_e_a_r___error.html#abd0ecb0136f4228db2bd963bfc1e20d7">getDebugInfo</a>()
<a name="l01035"></a>01035     {
<a name="l01036"></a>01036         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_p_e_a_r___error.html#a7e7999c3a04f08ffcc5e237fd28a6bc7">getUserInfo</a>();
<a name="l01037"></a>01037     }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039     <span class="comment">// }}}</span>
<a name="l01040"></a>01040     <span class="comment">// {{{ getBacktrace()</span>
<a name="l01041"></a>01041 
<a name="l01050"></a><a class="code" href="class_p_e_a_r___error.html#a523746992cb3bd031630886f7aaab6c4">01050</a>     function <a class="code" href="class_p_e_a_r___error.html#a523746992cb3bd031630886f7aaab6c4">getBacktrace</a>($frame = null)
<a name="l01051"></a>01051     {
<a name="l01052"></a>01052         <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;PEAR_IGNORE_BACKTRACE&#39;</span>)) {
<a name="l01053"></a>01053             <span class="keywordflow">return</span> null;
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055         <span class="keywordflow">if</span> ($frame === null) {
<a name="l01056"></a>01056             <span class="keywordflow">return</span> $this-&gt;backtrace;
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058         <span class="keywordflow">return</span> $this-&gt;backtrace[$frame];
<a name="l01059"></a>01059     }
<a name="l01060"></a>01060 
<a name="l01061"></a>01061     <span class="comment">// }}}</span>
<a name="l01062"></a>01062     <span class="comment">// {{{ addUserInfo()</span>
<a name="l01063"></a>01063 
<a name="l01064"></a><a class="code" href="class_p_e_a_r___error.html#af15ae508c62d99bdc084be5285c6a5e0">01064</a>     function <a class="code" href="class_p_e_a_r___error.html#af15ae508c62d99bdc084be5285c6a5e0">addUserInfo</a>($info)
<a name="l01065"></a>01065     {
<a name="l01066"></a>01066         <span class="keywordflow">if</span> (empty($this-&gt;userinfo)) {
<a name="l01067"></a>01067             $this-&gt;userinfo = $info;
<a name="l01068"></a>01068         } <span class="keywordflow">else</span> {
<a name="l01069"></a>01069             $this-&gt;userinfo .= <span class="stringliteral">&quot; ** $info&quot;</span>;
<a name="l01070"></a>01070         }
<a name="l01071"></a>01071     }
<a name="l01072"></a>01072 
<a name="l01073"></a>01073     <span class="comment">// }}}</span>
<a name="l01074"></a>01074     <span class="comment">// {{{ toString()</span>
<a name="l01075"></a><a class="code" href="class_p_e_a_r___error.html#a7516ca30af0db3cdbf9a7739b48ce91d">01075</a>     function <a class="code" href="class_p_e_a_r___error.html#a7516ca30af0db3cdbf9a7739b48ce91d">__toString</a>()
<a name="l01076"></a>01076     {
<a name="l01077"></a>01077         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_p_e_a_r___error.html#a0b0e611236742aac18ba1936d03ba89a">getMessage</a>();
<a name="l01078"></a>01078     }
<a name="l01079"></a>01079     <span class="comment">// }}}</span>
<a name="l01080"></a>01080     <span class="comment">// {{{ toString()</span>
<a name="l01081"></a>01081 
<a name="l01088"></a><a class="code" href="class_p_e_a_r___error.html#a5558c5d549f41597377fa1ea8a1cefa3">01088</a>     function <a class="code" href="class_p_e_a_r___error.html#a5558c5d549f41597377fa1ea8a1cefa3">toString</a>() {
<a name="l01089"></a>01089         $modes = array();
<a name="l01090"></a>01090         $levels = array(E_USER_NOTICE  =&gt; <span class="stringliteral">&#39;notice&#39;</span>,
<a name="l01091"></a>01091                         E_USER_WARNING =&gt; <span class="stringliteral">&#39;warning&#39;</span>,
<a name="l01092"></a>01092                         E_USER_ERROR   =&gt; <span class="stringliteral">&#39;error&#39;</span>);
<a name="l01093"></a>01093         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#a5c49fbcdc5acada3a56be2ef58ba339a">PEAR_ERROR_CALLBACK</a>) {
<a name="l01094"></a>01094             <span class="keywordflow">if</span> (is_array($this-&gt;callback)) {
<a name="l01095"></a>01095                 $callback = (is_object($this-&gt;callback[0]) ?
<a name="l01096"></a>01096                     strtolower(get_class($this-&gt;callback[0])) :
<a name="l01097"></a>01097                     $this-&gt;callback[0]) . <span class="stringliteral">&#39;::&#39;</span> .
<a name="l01098"></a>01098                     $this-&gt;callback[1];
<a name="l01099"></a>01099             } <span class="keywordflow">else</span> {
<a name="l01100"></a>01100                 $callback = $this-&gt;callback;
<a name="l01101"></a>01101             }
<a name="l01102"></a>01102             <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;[%s: message=&quot;%s&quot; code=%d mode=callback &#39;</span>.
<a name="l01103"></a>01103                            <span class="stringliteral">&#39;callback=%s prefix=&quot;%s&quot; info=&quot;%s&quot;]&#39;</span>,
<a name="l01104"></a>01104                            strtolower(get_class($this)), $this-&gt;message, $this-&gt;code,
<a name="l01105"></a>01105                            $callback, $this-&gt;error_message_prefix,
<a name="l01106"></a>01106                            $this-&gt;userinfo);
<a name="l01107"></a>01107         }
<a name="l01108"></a>01108         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#a8b7f75fdabaeb5ecfd7d11a109f6c40e">PEAR_ERROR_PRINT</a>) {
<a name="l01109"></a>01109             $modes[] = <span class="stringliteral">&#39;print&#39;</span>;
<a name="l01110"></a>01110         }
<a name="l01111"></a>01111         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#a92803d17e38c82a5d87bced1c18a10d8">PEAR_ERROR_TRIGGER</a>) {
<a name="l01112"></a>01112             $modes[] = <span class="stringliteral">&#39;trigger&#39;</span>;
<a name="l01113"></a>01113         }
<a name="l01114"></a>01114         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#abf813938f7ed79980a37b3adcb4ceb61">PEAR_ERROR_DIE</a>) {
<a name="l01115"></a>01115             $modes[] = <span class="stringliteral">&#39;die&#39;</span>;
<a name="l01116"></a>01116         }
<a name="l01117"></a>01117         <span class="keywordflow">if</span> ($this-&gt;mode &amp; <a class="code" href="_p_e_a_r_8php.html#acfe1d5846207d81d3b2882fabbd56840">PEAR_ERROR_RETURN</a>) {
<a name="l01118"></a>01118             $modes[] = <span class="stringliteral">&#39;return&#39;</span>;
<a name="l01119"></a>01119         }
<a name="l01120"></a>01120         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;[%s: message=&quot;%s&quot; code=%d mode=%s level=%s &#39;</span>.
<a name="l01121"></a>01121                        <span class="stringliteral">&#39;prefix=&quot;%s&quot; info=&quot;%s&quot;]&#39;</span>,
<a name="l01122"></a>01122                        strtolower(get_class($this)), $this-&gt;message, $this-&gt;code,
<a name="l01123"></a>01123                        implode(<span class="stringliteral">&quot;|&quot;</span>, $modes), $levels[$this-&gt;level],
<a name="l01124"></a>01124                        $this-&gt;error_message_prefix,
<a name="l01125"></a>01125                        $this-&gt;userinfo);
<a name="l01126"></a>01126     }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <span class="comment">// }}}</span>
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <span class="comment">/*</span>
<a name="l01132"></a>01132 <span class="comment"> * Local Variables:</span>
<a name="l01133"></a>01133 <span class="comment"> * mode: php</span>
<a name="l01134"></a>01134 <span class="comment"> * tab-width: 4</span>
<a name="l01135"></a>01135 <span class="comment"> * c-basic-offset: 4</span>
<a name="l01136"></a>01136 <span class="comment"> * End:</span>
<a name="l01137"></a>01137 <span class="comment"> */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Jul 7 2010 15:06:49 for zimbraControl by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
