<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>zimbraControl: classes/PEAR/XML/Unserializer.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>classes/PEAR/XML/Unserializer.php</h1>  </div>
</div>
<div class="contents">
<a href="_unserializer_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?<a class="code" href="category_p_h_p.html">PHP</a>
<a name="l00002"></a>00002 <span class="comment">/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: */</span>
<a name="l00003"></a>00003 
<a name="l00053"></a>00053 require_once <span class="stringliteral">&#39;PEAR.php&#39;</span>;
<a name="l00054"></a>00054 
<a name="l00058"></a>00058 require_once <span class="stringliteral">&#39;XML/Parser.php&#39;</span>;
<a name="l00059"></a>00059 
<a name="l00068"></a><a class="code" href="_unserializer_8php.html#a585a77c9cbf34ee4a8de3c24261775aa">00068</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_COMPLEXTYPE&#39;</span>, <span class="stringliteral">&#39;complexType&#39;</span>);
<a name="l00069"></a>00069 
<a name="l00076"></a><a class="code" href="_unserializer_8php.html#a19afc453a62b6755a447fe39f3dac37e">00076</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY&#39;</span>, <span class="stringliteral">&#39;keyAttribute&#39;</span>);
<a name="l00077"></a>00077 
<a name="l00084"></a><a class="code" href="_unserializer_8php.html#a8117dbe6f7f02c7946f86cde67c6db8d">00084</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTE_TYPE&#39;</span>, <span class="stringliteral">&#39;typeAttribute&#39;</span>);
<a name="l00085"></a>00085 
<a name="l00092"></a><a class="code" href="_unserializer_8php.html#ab51b125c33b3fa4a889dc5d9cb5cdfab">00092</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTE_CLASS&#39;</span>, <span class="stringliteral">&#39;classAttribute&#39;</span>);
<a name="l00093"></a>00093 
<a name="l00100"></a><a class="code" href="_unserializer_8php.html#a617ce9d7133f97f4cdcd5ba2e28a54ef">00100</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_TAG_AS_CLASSNAME&#39;</span>, <span class="stringliteral">&#39;tagAsClass&#39;</span>);
<a name="l00101"></a>00101 
<a name="l00108"></a><a class="code" href="_unserializer_8php.html#a63b0aa6a14c677de6da16b60a15df82e">00108</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_DEFAULT_CLASS&#39;</span>, <span class="stringliteral">&#39;defaultClass&#39;</span>);
<a name="l00109"></a>00109 
<a name="l00116"></a><a class="code" href="_unserializer_8php.html#a93feba99e3f5cabb572ed282697c1eb3">00116</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTES_PARSE&#39;</span>, <span class="stringliteral">&#39;parseAttributes&#39;</span>);
<a name="l00117"></a>00117 
<a name="l00125"></a><a class="code" href="_unserializer_8php.html#a5e56b54c24cd833591183b6c90dea478">00125</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTES_ARRAYKEY&#39;</span>, <span class="stringliteral">&#39;attributesArray&#39;</span>);
<a name="l00126"></a>00126 
<a name="l00134"></a><a class="code" href="_unserializer_8php.html#a6376450ce4999eabd864675654b9631a">00134</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ATTRIBUTES_PREPEND&#39;</span>, <span class="stringliteral">&#39;prependAttributes&#39;</span>);
<a name="l00135"></a>00135 
<a name="l00143"></a><a class="code" href="_unserializer_8php.html#a658615a49917028945970e19c4bdac2c">00143</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_CONTENT_KEY&#39;</span>, <span class="stringliteral">&#39;contentName&#39;</span>);
<a name="l00144"></a>00144 
<a name="l00151"></a><a class="code" href="_unserializer_8php.html#ae5229dcb5a0c246dd0130172d2b10ed4">00151</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_TAG_MAP&#39;</span>, <span class="stringliteral">&#39;tagMap&#39;</span>);
<a name="l00152"></a>00152 
<a name="l00159"></a><a class="code" href="_unserializer_8php.html#a9760129e0d8120c4b6870632cd1706d7">00159</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_FORCE_ENUM&#39;</span>, <span class="stringliteral">&#39;forceEnum&#39;</span>);
<a name="l00160"></a>00160 
<a name="l00168"></a><a class="code" href="_unserializer_8php.html#a0e18136f9d4e0d217b9acbd913fbbdb9">00168</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ENCODING_SOURCE&#39;</span>, <span class="stringliteral">&#39;encoding&#39;</span>);
<a name="l00169"></a>00169 
<a name="l00177"></a><a class="code" href="_unserializer_8php.html#a13462e0e1e307ac62cde11f8c6e89238">00177</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_ENCODING_TARGET&#39;</span>, <span class="stringliteral">&#39;targetEncoding&#39;</span>);
<a name="l00178"></a>00178 
<a name="l00185"></a><a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">00185</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_DECODE_FUNC&#39;</span>, <span class="stringliteral">&#39;decodeFunction&#39;</span>);
<a name="l00186"></a>00186 
<a name="l00194"></a><a class="code" href="_unserializer_8php.html#ae6b093610f05e0263c844d948442e2b8">00194</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_RETURN_RESULT&#39;</span>, <span class="stringliteral">&#39;returnResult&#39;</span>);
<a name="l00195"></a>00195 
<a name="l00204"></a><a class="code" href="_unserializer_8php.html#aeaedf6d2dc9df75c03bec1d12abe3826">00204</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_WHITESPACE&#39;</span>, <span class="stringliteral">&#39;whitespace&#39;</span>);
<a name="l00205"></a>00205 
<a name="l00209"></a><a class="code" href="_unserializer_8php.html#a9558d9cb2fa941ab6af1f9368cc4d3f4">00209</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_WHITESPACE_KEEP&#39;</span>, <span class="stringliteral">&#39;keep&#39;</span>);
<a name="l00210"></a>00210 
<a name="l00214"></a><a class="code" href="_unserializer_8php.html#a4bd7ddaae6f41f69de1ecb40f3d2cf19">00214</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_WHITESPACE_TRIM&#39;</span>, <span class="stringliteral">&#39;trim&#39;</span>);
<a name="l00215"></a>00215 
<a name="l00219"></a><a class="code" href="_unserializer_8php.html#afba9bf793daa42eacf1a0422c9c2861e">00219</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_WHITESPACE_NORMALIZE&#39;</span>, <span class="stringliteral">&#39;normalize&#39;</span>);
<a name="l00220"></a>00220 
<a name="l00228"></a><a class="code" href="_unserializer_8php.html#a0e4f34c2b259418b5f1844fa276d40e4">00228</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_OVERRIDE_OPTIONS&#39;</span>, <span class="stringliteral">&#39;overrideOptions&#39;</span>);
<a name="l00229"></a>00229 
<a name="l00233"></a><a class="code" href="_unserializer_8php.html#a0eacaec261065e76ebff33dd73aa60cb">00233</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_IGNORE_KEYS&#39;</span>, <span class="stringliteral">&#39;ignoreKeys&#39;</span>);
<a name="l00234"></a>00234 
<a name="l00238"></a><a class="code" href="_unserializer_8php.html#a52711fbb3eaa939abc57ed0be9625b6a">00238</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_OPTION_GUESS_TYPES&#39;</span>, <span class="stringliteral">&#39;guessTypes&#39;</span>);
<a name="l00239"></a>00239 
<a name="l00243"></a><a class="code" href="_unserializer_8php.html#afe82a848f3c67004130a7048a26f6416">00243</a> define(<span class="stringliteral">&#39;XML_UNSERIALIZER_ERROR_NO_UNSERIALIZATION&#39;</span>, 151);
<a name="l00244"></a>00244 
<a name="l00276"></a><a class="code" href="class_x_m_l___unserializer.html">00276</a> <span class="keyword">class </span><a class="code" href="class_x_m_l___unserializer.html">XML_Unserializer</a> <span class="keyword">extends</span> PEAR
<a name="l00277"></a>00277 {
<a name="l00284"></a><a class="code" href="class_x_m_l___unserializer.html#a740a98520da60a6f528c8f8db10e1028">00284</a>     var <a class="code" href="class_x_m_l___unserializer.html#a740a98520da60a6f528c8f8db10e1028">$_knownOptions</a> = array(
<a name="l00285"></a>00285                                 <a class="code" href="_unserializer_8php.html#a585a77c9cbf34ee4a8de3c24261775aa">XML_UNSERIALIZER_OPTION_COMPLEXTYPE</a>,
<a name="l00286"></a>00286                                 <a class="code" href="_unserializer_8php.html#a19afc453a62b6755a447fe39f3dac37e">XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY</a>,
<a name="l00287"></a>00287                                 <a class="code" href="_unserializer_8php.html#a8117dbe6f7f02c7946f86cde67c6db8d">XML_UNSERIALIZER_OPTION_ATTRIBUTE_TYPE</a>,
<a name="l00288"></a>00288                                 <a class="code" href="_unserializer_8php.html#ab51b125c33b3fa4a889dc5d9cb5cdfab">XML_UNSERIALIZER_OPTION_ATTRIBUTE_CLASS</a>,
<a name="l00289"></a>00289                                 <a class="code" href="_unserializer_8php.html#a617ce9d7133f97f4cdcd5ba2e28a54ef">XML_UNSERIALIZER_OPTION_TAG_AS_CLASSNAME</a>,
<a name="l00290"></a>00290                                 <a class="code" href="_unserializer_8php.html#a63b0aa6a14c677de6da16b60a15df82e">XML_UNSERIALIZER_OPTION_DEFAULT_CLASS</a>,
<a name="l00291"></a>00291                                 <a class="code" href="_unserializer_8php.html#a93feba99e3f5cabb572ed282697c1eb3">XML_UNSERIALIZER_OPTION_ATTRIBUTES_PARSE</a>,
<a name="l00292"></a>00292                                 <a class="code" href="_unserializer_8php.html#a5e56b54c24cd833591183b6c90dea478">XML_UNSERIALIZER_OPTION_ATTRIBUTES_ARRAYKEY</a>,
<a name="l00293"></a>00293                                 <a class="code" href="_unserializer_8php.html#a6376450ce4999eabd864675654b9631a">XML_UNSERIALIZER_OPTION_ATTRIBUTES_PREPEND</a>,
<a name="l00294"></a>00294                                 <a class="code" href="_unserializer_8php.html#a658615a49917028945970e19c4bdac2c">XML_UNSERIALIZER_OPTION_CONTENT_KEY</a>,
<a name="l00295"></a>00295                                 <a class="code" href="_unserializer_8php.html#ae5229dcb5a0c246dd0130172d2b10ed4">XML_UNSERIALIZER_OPTION_TAG_MAP</a>,
<a name="l00296"></a>00296                                 <a class="code" href="_unserializer_8php.html#a9760129e0d8120c4b6870632cd1706d7">XML_UNSERIALIZER_OPTION_FORCE_ENUM</a>,
<a name="l00297"></a>00297                                 <a class="code" href="_unserializer_8php.html#a0e18136f9d4e0d217b9acbd913fbbdb9">XML_UNSERIALIZER_OPTION_ENCODING_SOURCE</a>,
<a name="l00298"></a>00298                                 <a class="code" href="_unserializer_8php.html#a13462e0e1e307ac62cde11f8c6e89238">XML_UNSERIALIZER_OPTION_ENCODING_TARGET</a>,
<a name="l00299"></a>00299                                 <a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a>,
<a name="l00300"></a>00300                                 <a class="code" href="_unserializer_8php.html#ae6b093610f05e0263c844d948442e2b8">XML_UNSERIALIZER_OPTION_RETURN_RESULT</a>,
<a name="l00301"></a>00301                                 <a class="code" href="_unserializer_8php.html#aeaedf6d2dc9df75c03bec1d12abe3826">XML_UNSERIALIZER_OPTION_WHITESPACE</a>,
<a name="l00302"></a>00302                                 <a class="code" href="_unserializer_8php.html#a0eacaec261065e76ebff33dd73aa60cb">XML_UNSERIALIZER_OPTION_IGNORE_KEYS</a>,
<a name="l00303"></a>00303                                 <a class="code" href="_unserializer_8php.html#a52711fbb3eaa939abc57ed0be9625b6a">XML_UNSERIALIZER_OPTION_GUESS_TYPES</a>
<a name="l00304"></a>00304                               );
<a name="l00311"></a><a class="code" href="class_x_m_l___unserializer.html#a61f8e37bb59579db7eca5d6bd914441d">00311</a>     var <a class="code" href="class_x_m_l___unserializer.html#a61f8e37bb59579db7eca5d6bd914441d">$_defaultOptions</a> = array(
<a name="l00312"></a>00312         <span class="comment">// complex types will be converted to arrays, if no type hint is given</span>
<a name="l00313"></a>00313         <a class="code" href="_unserializer_8php.html#a585a77c9cbf34ee4a8de3c24261775aa">XML_UNSERIALIZER_OPTION_COMPLEXTYPE</a> =&gt; <span class="stringliteral">&#39;array&#39;</span>,
<a name="l00314"></a>00314 
<a name="l00315"></a>00315         <span class="comment">// get array key/property name from this attribute</span>
<a name="l00316"></a>00316         <a class="code" href="_unserializer_8php.html#a19afc453a62b6755a447fe39f3dac37e">XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY</a> =&gt; <span class="stringliteral">&#39;_originalKey&#39;</span>,
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="comment">// get type from this attribute</span>
<a name="l00319"></a>00319         <a class="code" href="_unserializer_8php.html#a8117dbe6f7f02c7946f86cde67c6db8d">XML_UNSERIALIZER_OPTION_ATTRIBUTE_TYPE</a> =&gt; <span class="stringliteral">&#39;_type&#39;</span>,
<a name="l00320"></a>00320 
<a name="l00321"></a>00321         <span class="comment">// get class from this attribute (if not given, use tag name)</span>
<a name="l00322"></a>00322         <a class="code" href="_unserializer_8php.html#ab51b125c33b3fa4a889dc5d9cb5cdfab">XML_UNSERIALIZER_OPTION_ATTRIBUTE_CLASS</a> =&gt; <span class="stringliteral">&#39;_class&#39;</span>,
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         <span class="comment">// use the tagname as the classname</span>
<a name="l00325"></a>00325         <a class="code" href="_unserializer_8php.html#a617ce9d7133f97f4cdcd5ba2e28a54ef">XML_UNSERIALIZER_OPTION_TAG_AS_CLASSNAME</a> =&gt; <span class="keyword">true</span>,
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="comment">// name of the class that is used to create objects</span>
<a name="l00328"></a>00328         <a class="code" href="_unserializer_8php.html#a63b0aa6a14c677de6da16b60a15df82e">XML_UNSERIALIZER_OPTION_DEFAULT_CLASS</a> =&gt; <span class="stringliteral">&#39;stdClass&#39;</span>,
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         <span class="comment">// parse the attributes of the tag into an array</span>
<a name="l00331"></a>00331         <a class="code" href="_unserializer_8php.html#a93feba99e3f5cabb572ed282697c1eb3">XML_UNSERIALIZER_OPTION_ATTRIBUTES_PARSE</a> =&gt; <span class="keyword">false</span>,
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="comment">// parse them into sperate array (specify name of array here)</span>
<a name="l00334"></a>00334         <a class="code" href="_unserializer_8php.html#a5e56b54c24cd833591183b6c90dea478">XML_UNSERIALIZER_OPTION_ATTRIBUTES_ARRAYKEY</a> =&gt; <span class="keyword">false</span>,
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         <span class="comment">// prepend attribute names with this string</span>
<a name="l00337"></a>00337         <a class="code" href="_unserializer_8php.html#a6376450ce4999eabd864675654b9631a">XML_UNSERIALIZER_OPTION_ATTRIBUTES_PREPEND</a> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         <span class="comment">// put cdata found in a tag that has been converted</span>
<a name="l00340"></a>00340         <span class="comment">// to a complex type in this key</span>
<a name="l00341"></a>00341         <a class="code" href="_unserializer_8php.html#a658615a49917028945970e19c4bdac2c">XML_UNSERIALIZER_OPTION_CONTENT_KEY</a> =&gt; <span class="stringliteral">&#39;_content&#39;</span>,
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <span class="comment">// use this to map tagnames</span>
<a name="l00344"></a>00344         <a class="code" href="_unserializer_8php.html#ae5229dcb5a0c246dd0130172d2b10ed4">XML_UNSERIALIZER_OPTION_TAG_MAP</a> =&gt; array(),
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         <span class="comment">// these tags will always be an indexed array</span>
<a name="l00347"></a>00347         <a class="code" href="_unserializer_8php.html#a9760129e0d8120c4b6870632cd1706d7">XML_UNSERIALIZER_OPTION_FORCE_ENUM</a> =&gt; array(),
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="comment">// specify the encoding character of the document to parse</span>
<a name="l00350"></a>00350         <a class="code" href="_unserializer_8php.html#a0e18136f9d4e0d217b9acbd913fbbdb9">XML_UNSERIALIZER_OPTION_ENCODING_SOURCE</a> =&gt; null,
<a name="l00351"></a>00351 
<a name="l00352"></a>00352         <span class="comment">// specify the target encoding</span>
<a name="l00353"></a>00353         <a class="code" href="_unserializer_8php.html#a13462e0e1e307ac62cde11f8c6e89238">XML_UNSERIALIZER_OPTION_ENCODING_TARGET</a> =&gt; null,
<a name="l00354"></a>00354 
<a name="l00355"></a>00355         <span class="comment">// function used to decode data</span>
<a name="l00356"></a>00356         <a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a> =&gt; null,
<a name="l00357"></a>00357 
<a name="l00358"></a>00358         <span class="comment">// unserialize() returns the result of the unserialization instead of true</span>
<a name="l00359"></a>00359         <a class="code" href="_unserializer_8php.html#ae6b093610f05e0263c844d948442e2b8">XML_UNSERIALIZER_OPTION_RETURN_RESULT</a> =&gt; <span class="keyword">false</span>,
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="comment">// remove whitespace around data</span>
<a name="l00362"></a>00362         <a class="code" href="_unserializer_8php.html#aeaedf6d2dc9df75c03bec1d12abe3826">XML_UNSERIALIZER_OPTION_WHITESPACE</a> =&gt; <a class="code" href="_unserializer_8php.html#a4bd7ddaae6f41f69de1ecb40f3d2cf19">XML_UNSERIALIZER_WHITESPACE_TRIM</a>,
<a name="l00363"></a>00363 
<a name="l00364"></a>00364         <span class="comment">// List of tags that will automatically be added to the parent,</span>
<a name="l00365"></a>00365         <span class="comment">// instead of adding a new key</span>
<a name="l00366"></a>00366         <a class="code" href="_unserializer_8php.html#a0eacaec261065e76ebff33dd73aa60cb">XML_UNSERIALIZER_OPTION_IGNORE_KEYS</a> =&gt; array(),
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         <span class="comment">// Whether to use type guessing</span>
<a name="l00369"></a>00369         <a class="code" href="_unserializer_8php.html#a52711fbb3eaa939abc57ed0be9625b6a">XML_UNSERIALIZER_OPTION_GUESS_TYPES</a> =&gt; <span class="keyword">false</span>
<a name="l00370"></a>00370     );
<a name="l00371"></a>00371 
<a name="l00378"></a><a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">00378</a>     var <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a> = array();
<a name="l00379"></a>00379 
<a name="l00386"></a><a class="code" href="class_x_m_l___unserializer.html#ac4d49879921a8f7ce3dcee9dd69e4ca8">00386</a>     var <a class="code" href="class_x_m_l___unserializer.html#ac4d49879921a8f7ce3dcee9dd69e4ca8">$_unserializedData</a> = null;
<a name="l00387"></a>00387 
<a name="l00394"></a><a class="code" href="class_x_m_l___unserializer.html#a15ea8c78d28d8d9b6023dedbe622c731">00394</a>     var <a class="code" href="class_x_m_l___unserializer.html#a15ea8c78d28d8d9b6023dedbe622c731">$_root</a> = null;
<a name="l00395"></a>00395 
<a name="l00402"></a><a class="code" href="class_x_m_l___unserializer.html#a02be3dcfe89011aaba0fd9bf9d3dfa98">00402</a>     var <a class="code" href="class_x_m_l___unserializer.html#a02be3dcfe89011aaba0fd9bf9d3dfa98">$_dataStack</a> = array();
<a name="l00403"></a>00403 
<a name="l00410"></a><a class="code" href="class_x_m_l___unserializer.html#ae151b737967b839780a7b0eba5a0c2d8">00410</a>     var <a class="code" href="class_x_m_l___unserializer.html#ae151b737967b839780a7b0eba5a0c2d8">$_valStack</a> = array();
<a name="l00411"></a>00411 
<a name="l00418"></a><a class="code" href="class_x_m_l___unserializer.html#a36ff29aa2da1b040fa91287e303bbebc">00418</a>     var <a class="code" href="class_x_m_l___unserializer.html#a36ff29aa2da1b040fa91287e303bbebc">$_depth</a> = 0;
<a name="l00419"></a>00419 
<a name="l00426"></a><a class="code" href="class_x_m_l___unserializer.html#a84bd71740cc8cf59439a9ddc5b5ad8cd">00426</a>     var <a class="code" href="class_x_m_l___unserializer.html#a84bd71740cc8cf59439a9ddc5b5ad8cd">$_parser</a> = null;
<a name="l00427"></a>00427 
<a name="l00435"></a><a class="code" href="class_x_m_l___unserializer.html#a1b1c3ff8540c8152a1657941e4e10833">00435</a>     function <a class="code" href="class_x_m_l___unserializer.html#a1b1c3ff8540c8152a1657941e4e10833">XML_Unserializer</a>(<a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a> = null)
<a name="l00436"></a>00436     {
<a name="l00437"></a>00437         <span class="keywordflow">if</span> (is_array(<a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>)) {
<a name="l00438"></a>00438             $this-&gt;options = array_merge($this-&gt;_defaultOptions, <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>);
<a name="l00439"></a>00439         } <span class="keywordflow">else</span> {
<a name="l00440"></a>00440             $this-&gt;options = $this-&gt;_defaultOptions;
<a name="l00441"></a>00441         }
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443 
<a name="l00451"></a><a class="code" href="class_x_m_l___unserializer.html#aa162e09c6645943bd27c88a15c0059fd">00451</a>     function <a class="code" href="class_x_m_l___unserializer.html#aa162e09c6645943bd27c88a15c0059fd">apiVersion</a>()
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453         <span class="keywordflow">return</span> <span class="stringliteral">&#39;0.20.0&#39;</span>;
<a name="l00454"></a>00454     }
<a name="l00455"></a>00455 
<a name="l00463"></a><a class="code" href="class_x_m_l___unserializer.html#a58693f7b99552413d9296e986bc22bb9">00463</a>     function <a class="code" href="class_x_m_l___unserializer.html#a58693f7b99552413d9296e986bc22bb9">resetOptions</a>()
<a name="l00464"></a>00464     {
<a name="l00465"></a>00465         $this-&gt;options = $this-&gt;_defaultOptions;
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467 
<a name="l00481"></a><a class="code" href="class_x_m_l___unserializer.html#a7184fec9134a57cae6ef66b3588513d1">00481</a>     function <a class="code" href="class_x_m_l___unserializer.html#a7184fec9134a57cae6ef66b3588513d1">setOption</a>($name, $value)
<a name="l00482"></a>00482     {
<a name="l00483"></a>00483         $this-&gt;options[$name] = $value;
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 
<a name="l00498"></a><a class="code" href="class_x_m_l___unserializer.html#a8213e4c39213f7d6250f72ff6f2699f2">00498</a>     function <a class="code" href="class_x_m_l___unserializer.html#a8213e4c39213f7d6250f72ff6f2699f2">setOptions</a>(<a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>)
<a name="l00499"></a>00499     {
<a name="l00500"></a>00500         $this-&gt;options = array_merge($this-&gt;options, <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>);
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502 
<a name="l00514"></a><a class="code" href="class_x_m_l___unserializer.html#a1218c5b4aa9f82ab1b4ca46296551be0">00514</a>     function <a class="code" href="class_x_m_l___unserializer.html#a1218c5b4aa9f82ab1b4ca46296551be0">unserialize</a>($data, $isFile = <span class="keyword">false</span>, <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a> = null)
<a name="l00515"></a>00515     {
<a name="l00516"></a>00516         $this-&gt;_unserializedData = null;
<a name="l00517"></a>00517         $this-&gt;_root             = null;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="comment">// if options have been specified, use them instead</span>
<a name="l00520"></a>00520         <span class="comment">// of the previously defined ones</span>
<a name="l00521"></a>00521         <span class="keywordflow">if</span> (is_array(<a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>)) {
<a name="l00522"></a>00522             $optionsBak = $this-&gt;options;
<a name="l00523"></a>00523             <span class="keywordflow">if</span> (isset(<a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>[<a class="code" href="_unserializer_8php.html#a0e4f34c2b259418b5f1844fa276d40e4">XML_UNSERIALIZER_OPTION_OVERRIDE_OPTIONS</a>])
<a name="l00524"></a>00524                 &amp;&amp; <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>[XML_UNSERIALIZER_OPTION_OVERRIDE_OPTIONS] == <span class="keyword">true</span>
<a name="l00525"></a>00525             ) {
<a name="l00526"></a>00526                 $this-&gt;options = array_merge($this-&gt;_defaultOptions, <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>);
<a name="l00527"></a>00527             } <span class="keywordflow">else</span> {
<a name="l00528"></a>00528                 $this-&gt;options = array_merge($this-&gt;options, <a class="code" href="class_x_m_l___unserializer.html#a011800c63ece4cbbfa77136a20607023">$options</a>);
<a name="l00529"></a>00529             }
<a name="l00530"></a>00530         } <span class="keywordflow">else</span> {
<a name="l00531"></a>00531             $optionsBak = null;
<a name="l00532"></a>00532         }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         $this-&gt;_valStack  = array();
<a name="l00535"></a>00535         $this-&gt;_dataStack = array();
<a name="l00536"></a>00536         $this-&gt;_depth     = 0;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538         $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a3be6808013e69bdceebe258c94575859">_createParser</a>();
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         <span class="keywordflow">if</span> (is_string($data)) {
<a name="l00541"></a>00541             <span class="keywordflow">if</span> ($isFile) {
<a name="l00542"></a>00542                 $result = $this-&gt;_parser-&gt;setInputFile($data);
<a name="l00543"></a>00543                 <span class="keywordflow">if</span> (PEAR::isError($result)) {
<a name="l00544"></a>00544                     <span class="keywordflow">return</span> $result;
<a name="l00545"></a>00545                 }
<a name="l00546"></a>00546                 $result = $this-&gt;_parser-&gt;parse();
<a name="l00547"></a>00547             } <span class="keywordflow">else</span> {
<a name="l00548"></a>00548                 $result = $this-&gt;_parser-&gt;parseString($data, <span class="keyword">true</span>);
<a name="l00549"></a>00549             }
<a name="l00550"></a>00550         } <span class="keywordflow">else</span> {
<a name="l00551"></a>00551             $this-&gt;_parser-&gt;setInput($data);
<a name="l00552"></a>00552             $result = $this-&gt;_parser-&gt;parse();
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555         <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#ae6b093610f05e0263c844d948442e2b8">XML_UNSERIALIZER_OPTION_RETURN_RESULT</a>] === <span class="keyword">true</span>) {
<a name="l00556"></a>00556             $return = $this-&gt;_unserializedData;
<a name="l00557"></a>00557         } <span class="keywordflow">else</span> {
<a name="l00558"></a>00558             $return = <span class="keyword">true</span>;
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561         <span class="keywordflow">if</span> ($optionsBak !== null) {
<a name="l00562"></a>00562             $this-&gt;options = $optionsBak;
<a name="l00563"></a>00563         }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565         <span class="keywordflow">if</span> (PEAR::isError($result)) {
<a name="l00566"></a>00566             <span class="keywordflow">return</span> $result;
<a name="l00567"></a>00567         }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569         <span class="keywordflow">return</span> $return;
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00578"></a><a class="code" href="class_x_m_l___unserializer.html#a957de2a743e847a59d133dd7132ded00">00578</a>     function <a class="code" href="class_x_m_l___unserializer.html#a957de2a743e847a59d133dd7132ded00">getUnserializedData</a>()
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580         <span class="keywordflow">if</span> ($this-&gt;_root === null) {
<a name="l00581"></a>00581             <span class="keywordflow">return</span> $this-&gt;raiseError(<span class="stringliteral">&#39;No unserialized data available. &#39;</span>
<a name="l00582"></a>00582                 . <span class="stringliteral">&#39;Use XML_Unserializer::unserialize() first.&#39;</span>,
<a name="l00583"></a>00583                 <a class="code" href="_unserializer_8php.html#afe82a848f3c67004130a7048a26f6416">XML_UNSERIALIZER_ERROR_NO_UNSERIALIZATION</a>);
<a name="l00584"></a>00584         }
<a name="l00585"></a>00585         <span class="keywordflow">return</span> $this-&gt;_unserializedData;
<a name="l00586"></a>00586     }
<a name="l00587"></a>00587 
<a name="l00594"></a><a class="code" href="class_x_m_l___unserializer.html#a59b88bf9688827940edc63bb0a976e79">00594</a>     function <a class="code" href="class_x_m_l___unserializer.html#a59b88bf9688827940edc63bb0a976e79">getRootName</a>()
<a name="l00595"></a>00595     {
<a name="l00596"></a>00596         <span class="keywordflow">if</span> ($this-&gt;_root === null) {
<a name="l00597"></a>00597             <span class="keywordflow">return</span> $this-&gt;raiseError(<span class="stringliteral">&#39;No unserialized data available. &#39;</span>
<a name="l00598"></a>00598                 . <span class="stringliteral">&#39;Use XML_Unserializer::unserialize() first.&#39;</span>,
<a name="l00599"></a>00599                 <a class="code" href="_unserializer_8php.html#afe82a848f3c67004130a7048a26f6416">XML_UNSERIALIZER_ERROR_NO_UNSERIALIZATION</a>);
<a name="l00600"></a>00600         }
<a name="l00601"></a>00601         <span class="keywordflow">return</span> $this-&gt;_root;
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603 
<a name="l00614"></a><a class="code" href="class_x_m_l___unserializer.html#a0088ace1702adcb4fff6f08cd9cdaedf">00614</a>     function <a class="code" href="class_x_m_l___unserializer.html#a0088ace1702adcb4fff6f08cd9cdaedf">startHandler</a>($parser, $element, $attribs)
<a name="l00615"></a>00615     {
<a name="l00616"></a>00616         <span class="keywordflow">if</span> (isset($attribs[$this-&gt;options[<a class="code" href="_unserializer_8php.html#a8117dbe6f7f02c7946f86cde67c6db8d">XML_UNSERIALIZER_OPTION_ATTRIBUTE_TYPE</a>]])
<a name="l00617"></a>00617         ) {
<a name="l00618"></a>00618             $type = $attribs[$this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_TYPE]];
<a name="l00619"></a>00619 
<a name="l00620"></a>00620             $guessType = <span class="keyword">false</span>;
<a name="l00621"></a>00621         } <span class="keywordflow">else</span> {
<a name="l00622"></a>00622             $type = <span class="stringliteral">&#39;string&#39;</span>;
<a name="l00623"></a>00623             <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a52711fbb3eaa939abc57ed0be9625b6a">XML_UNSERIALIZER_OPTION_GUESS_TYPES</a>] === <span class="keyword">true</span>) {
<a name="l00624"></a>00624                 $guessType = <span class="keyword">true</span>;
<a name="l00625"></a>00625             } <span class="keywordflow">else</span> {
<a name="l00626"></a>00626                 $guessType = <span class="keyword">false</span>;
<a name="l00627"></a>00627             }
<a name="l00628"></a>00628         }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630         <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a>] !== null) {
<a name="l00631"></a>00631             $attribs = array_map($this-&gt;options[<a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a>],
<a name="l00632"></a>00632                 $attribs);
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635         $this-&gt;_depth++;
<a name="l00636"></a>00636         $this-&gt;_dataStack[$this-&gt;_depth] = null;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638         <span class="keywordflow">if</span> (is_array($this-&gt;options[<a class="code" href="_unserializer_8php.html#ae5229dcb5a0c246dd0130172d2b10ed4">XML_UNSERIALIZER_OPTION_TAG_MAP</a>])
<a name="l00639"></a>00639             &amp;&amp; isset($this-&gt;options[XML_UNSERIALIZER_OPTION_TAG_MAP][$element])
<a name="l00640"></a>00640         ) {
<a name="l00641"></a>00641             $element = $this-&gt;options[XML_UNSERIALIZER_OPTION_TAG_MAP][$element];
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644         $val = array(
<a name="l00645"></a>00645                      <span class="stringliteral">&#39;name&#39;</span>         =&gt; $element,
<a name="l00646"></a>00646                      <span class="stringliteral">&#39;value&#39;</span>        =&gt; null,
<a name="l00647"></a>00647                      <span class="stringliteral">&#39;type&#39;</span>         =&gt; $type,
<a name="l00648"></a>00648                      <span class="stringliteral">&#39;guessType&#39;</span>    =&gt; $guessType,
<a name="l00649"></a>00649                      <span class="stringliteral">&#39;childrenKeys&#39;</span> =&gt; array(),
<a name="l00650"></a>00650                      <span class="stringliteral">&#39;aggregKeys&#39;</span>   =&gt; array()
<a name="l00651"></a>00651                     );
<a name="l00652"></a>00652 
<a name="l00653"></a>00653         <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a93feba99e3f5cabb572ed282697c1eb3">XML_UNSERIALIZER_OPTION_ATTRIBUTES_PARSE</a>] == <span class="keyword">true</span>
<a name="l00654"></a>00654             &amp;&amp; (count($attribs) &gt; 0)
<a name="l00655"></a>00655         ) {
<a name="l00656"></a>00656             $val[<span class="stringliteral">&#39;children&#39;</span>] = array();
<a name="l00657"></a>00657             $val[<span class="stringliteral">&#39;type&#39;</span>]     = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a772a613a5bd0f01f4cc851f5cafa33f8">_getComplexType</a>($element);
<a name="l00658"></a>00658             $val[<span class="stringliteral">&#39;class&#39;</span>]    = $element;
<a name="l00659"></a>00659 
<a name="l00660"></a>00660             <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a52711fbb3eaa939abc57ed0be9625b6a">XML_UNSERIALIZER_OPTION_GUESS_TYPES</a>] === <span class="keyword">true</span>) {
<a name="l00661"></a>00661                 $attribs = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a882db1cdca376c20daa63e828c256695">_guessAndSetTypes</a>($attribs);
<a name="l00662"></a>00662             }
<a name="l00663"></a>00663             <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a5e56b54c24cd833591183b6c90dea478">XML_UNSERIALIZER_OPTION_ATTRIBUTES_ARRAYKEY</a>] != <span class="keyword">false</span>
<a name="l00664"></a>00664             ) {
<a name="l00665"></a>00665                 $val[<span class="stringliteral">&#39;children&#39;</span>][$this-&gt;
<a name="l00666"></a>00666                     options[XML_UNSERIALIZER_OPTION_ATTRIBUTES_ARRAYKEY]] = $attribs;
<a name="l00667"></a>00667             } <span class="keywordflow">else</span> {
<a name="l00668"></a>00668                 <span class="keywordflow">foreach</span> ($attribs as $attrib =&gt; $value) {
<a name="l00669"></a>00669                     $val[<span class="stringliteral">&#39;children&#39;</span>][$this-&gt;
<a name="l00670"></a>00670                         options[XML_UNSERIALIZER_OPTION_ATTRIBUTES_PREPEND]
<a name="l00671"></a>00671                         . $attrib] = $value;
<a name="l00672"></a>00672                 }
<a name="l00673"></a>00673             }
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676         $keyAttr = <span class="keyword">false</span>;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678         <span class="keywordflow">if</span> (is_string($this-&gt;options[<a class="code" href="_unserializer_8php.html#a19afc453a62b6755a447fe39f3dac37e">XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY</a>])) {
<a name="l00679"></a>00679             $keyAttr = $this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY];
<a name="l00680"></a>00680         } elseif (is_array($this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY])) {
<a name="l00681"></a>00681             <span class="keywordflow">if</span> (isset($this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY]
<a name="l00682"></a>00682                 [$element])
<a name="l00683"></a>00683             ) {
<a name="l00684"></a>00684                 $keyAttr =
<a name="l00685"></a>00685                     $this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY][$element];
<a name="l00686"></a>00686             } elseif (isset($this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY]
<a name="l00687"></a>00687                 [<span class="stringliteral">&#39;#default&#39;</span>])
<a name="l00688"></a>00688             ) {
<a name="l00689"></a>00689                 $keyAttr = $this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY]
<a name="l00690"></a>00690                 [<span class="stringliteral">&#39;#default&#39;</span>];
<a name="l00691"></a>00691             } elseif (isset($this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY]
<a name="l00692"></a>00692                 [<span class="stringliteral">&#39;__default&#39;</span>])
<a name="l00693"></a>00693             ) {
<a name="l00694"></a>00694                 <span class="comment">// keep this for BC</span>
<a name="l00695"></a>00695                 $keyAttr =
<a name="l00696"></a>00696                     $this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_KEY]
<a name="l00697"></a>00697                     [<span class="stringliteral">&#39;__default&#39;</span>];
<a name="l00698"></a>00698             }
<a name="l00699"></a>00699         }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701         <span class="keywordflow">if</span> ($keyAttr !== <span class="keyword">false</span> &amp;&amp; isset($attribs[$keyAttr])) {
<a name="l00702"></a>00702             $val[<span class="stringliteral">&#39;name&#39;</span>] = $attribs[$keyAttr];
<a name="l00703"></a>00703         }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705         <span class="keywordflow">if</span> (isset($attribs[$this-&gt;
<a name="l00706"></a>00706             options[<a class="code" href="_unserializer_8php.html#ab51b125c33b3fa4a889dc5d9cb5cdfab">XML_UNSERIALIZER_OPTION_ATTRIBUTE_CLASS</a>]])
<a name="l00707"></a>00707         ) {
<a name="l00708"></a>00708             $val[<span class="stringliteral">&#39;class&#39;</span>] =
<a name="l00709"></a>00709                 $attribs[$this-&gt;options[XML_UNSERIALIZER_OPTION_ATTRIBUTE_CLASS]];
<a name="l00710"></a>00710         }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         array_push($this-&gt;_valStack, $val);
<a name="l00713"></a>00713     }
<a name="l00714"></a>00714 
<a name="l00724"></a><a class="code" href="class_x_m_l___unserializer.html#a882db1cdca376c20daa63e828c256695">00724</a>     function <a class="code" href="class_x_m_l___unserializer.html#a882db1cdca376c20daa63e828c256695">_guessAndSetTypes</a>($array)
<a name="l00725"></a>00725     {
<a name="l00726"></a>00726         <span class="keywordflow">foreach</span> ($array as $key =&gt; $value) {
<a name="l00727"></a>00727             $array[$key] = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">_guessAndSetType</a>($value);
<a name="l00728"></a>00728         }
<a name="l00729"></a>00729         <span class="keywordflow">return</span> $array;
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731 
<a name="l00741"></a><a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">00741</a>     function <a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">_guessAndSetType</a>($value)
<a name="l00742"></a>00742     {
<a name="l00743"></a>00743         <span class="keywordflow">if</span> ($value === <span class="stringliteral">&#39;true&#39;</span>) {
<a name="l00744"></a>00744             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00745"></a>00745         }
<a name="l00746"></a>00746         <span class="keywordflow">if</span> ($value === <span class="stringliteral">&#39;false&#39;</span>) {
<a name="l00747"></a>00747             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749         <span class="keywordflow">if</span> ($value === <span class="stringliteral">&#39;NULL&#39;</span>) {
<a name="l00750"></a>00750             <span class="keywordflow">return</span> null;
<a name="l00751"></a>00751         }
<a name="l00752"></a>00752         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^[-+]?[0-9]{1,}\\z/&#39;</span>, $value)) {
<a name="l00753"></a>00753             <span class="keywordflow">return</span> intval($value);
<a name="l00754"></a>00754         }
<a name="l00755"></a>00755         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^[-+]?[0-9]{1,}\.[0-9]{1,}\\z/&#39;</span>, $value)) {
<a name="l00756"></a>00756             <span class="keywordflow">return</span> doubleval($value);
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758         <span class="keywordflow">return</span> (<span class="keywordtype">string</span>)$value;
<a name="l00759"></a>00759     }
<a name="l00760"></a>00760 
<a name="l00770"></a><a class="code" href="class_x_m_l___unserializer.html#a9d1e9011605c82ed505ad79c1ac10b8f">00770</a>     function <a class="code" href="class_x_m_l___unserializer.html#a9d1e9011605c82ed505ad79c1ac10b8f">endHandler</a>($parser, $element)
<a name="l00771"></a>00771     {
<a name="l00772"></a>00772         $value = array_pop($this-&gt;_valStack);
<a name="l00773"></a>00773         <span class="keywordflow">switch</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#aeaedf6d2dc9df75c03bec1d12abe3826">XML_UNSERIALIZER_OPTION_WHITESPACE</a>]) {
<a name="l00774"></a>00774         <span class="keywordflow">case</span> <a class="code" href="_unserializer_8php.html#a9558d9cb2fa941ab6af1f9368cc4d3f4">XML_UNSERIALIZER_WHITESPACE_KEEP</a>:
<a name="l00775"></a>00775             $data = $this-&gt;_dataStack[$this-&gt;_depth];
<a name="l00776"></a>00776             <span class="keywordflow">break</span>;
<a name="l00777"></a>00777         <span class="keywordflow">case</span> <a class="code" href="_unserializer_8php.html#afba9bf793daa42eacf1a0422c9c2861e">XML_UNSERIALIZER_WHITESPACE_NORMALIZE</a>:
<a name="l00778"></a>00778             $data = trim(preg_replace(<span class="stringliteral">&#39;/\s\s+/m&#39;</span>, <span class="charliteral">&#39; &#39;</span>,
<a name="l00779"></a>00779                 $this-&gt;_dataStack[$this-&gt;_depth]));
<a name="l00780"></a>00780             <span class="keywordflow">break</span>;
<a name="l00781"></a>00781         <span class="keywordflow">case</span> <a class="code" href="_unserializer_8php.html#a4bd7ddaae6f41f69de1ecb40f3d2cf19">XML_UNSERIALIZER_WHITESPACE_TRIM</a>:
<a name="l00782"></a>00782         <span class="keywordflow">default</span>:
<a name="l00783"></a>00783             $data = trim($this-&gt;_dataStack[$this-&gt;_depth]);
<a name="l00784"></a>00784             <span class="keywordflow">break</span>;
<a name="l00785"></a>00785         }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787         <span class="comment">// adjust type of the value</span>
<a name="l00788"></a>00788         <span class="keywordflow">switch</span>(strtolower($value[<span class="stringliteral">&#39;type&#39;</span>])) {
<a name="l00789"></a>00789 
<a name="l00790"></a>00790         <span class="comment">// unserialize an object</span>
<a name="l00791"></a>00791         <span class="keywordflow">case</span> <span class="stringliteral">&#39;object&#39;</span>:
<a name="l00792"></a>00792             <span class="keywordflow">if</span> (isset($value[<span class="stringliteral">&#39;class&#39;</span>])) {
<a name="l00793"></a>00793                 $classname = $value[<span class="stringliteral">&#39;class&#39;</span>];
<a name="l00794"></a>00794             } <span class="keywordflow">else</span> {
<a name="l00795"></a>00795                 $classname = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00796"></a>00796             }
<a name="l00797"></a>00797             <span class="comment">// instantiate the class</span>
<a name="l00798"></a>00798             <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a617ce9d7133f97f4cdcd5ba2e28a54ef">XML_UNSERIALIZER_OPTION_TAG_AS_CLASSNAME</a>] === <span class="keyword">true</span>
<a name="l00799"></a>00799                 &amp;&amp; class_exists($classname)
<a name="l00800"></a>00800             ) {
<a name="l00801"></a>00801                 $value[<span class="stringliteral">&#39;value&#39;</span>] = &amp;<span class="keyword">new</span> $classname;
<a name="l00802"></a>00802             } <span class="keywordflow">else</span> {
<a name="l00803"></a>00803                 $value[<span class="stringliteral">&#39;value&#39;</span>] =
<a name="l00804"></a>00804                     &amp;<span class="keyword">new</span> $this-&gt;options[XML_UNSERIALIZER_OPTION_DEFAULT_CLASS];
<a name="l00805"></a>00805             }
<a name="l00806"></a>00806             <span class="keywordflow">if</span> (trim($data) !== <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00807"></a>00807                 <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;guessType&#39;</span>] === <span class="keyword">true</span>) {
<a name="l00808"></a>00808                     $data = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">_guessAndSetType</a>($data);
<a name="l00809"></a>00809                 }
<a name="l00810"></a>00810                 $value[<span class="stringliteral">&#39;children&#39;</span>][$this-&gt;
<a name="l00811"></a>00811                     options[XML_UNSERIALIZER_OPTION_CONTENT_KEY]] = $data;
<a name="l00812"></a>00812             }
<a name="l00813"></a>00813 
<a name="l00814"></a>00814             <span class="comment">// set properties</span>
<a name="l00815"></a>00815             <span class="keywordflow">foreach</span> ($value[<span class="stringliteral">&#39;children&#39;</span>] as $prop =&gt; $propVal) {
<a name="l00816"></a>00816                 <span class="comment">// check whether there is a special method to set this property</span>
<a name="l00817"></a>00817                 $setMethod = <span class="stringliteral">&#39;set&#39;</span>.$prop;
<a name="l00818"></a>00818                 <span class="keywordflow">if</span> (method_exists($value[<span class="stringliteral">&#39;value&#39;</span>], $setMethod)) {
<a name="l00819"></a>00819                     call_user_func(array(&amp;$value[<span class="stringliteral">&#39;value&#39;</span>], $setMethod), $propVal);
<a name="l00820"></a>00820                 } <span class="keywordflow">else</span> {
<a name="l00821"></a>00821                     $value[<span class="stringliteral">&#39;value&#39;</span>]-&gt;$prop = $propVal;
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823             }
<a name="l00824"></a>00824             <span class="comment">//  check for magic function</span>
<a name="l00825"></a>00825             <span class="keywordflow">if</span> (method_exists($value[<span class="stringliteral">&#39;value&#39;</span>], <span class="stringliteral">&#39;__wakeup&#39;</span>)) {
<a name="l00826"></a>00826                 $value[<span class="stringliteral">&#39;value&#39;</span>]-&gt;__wakeup();
<a name="l00827"></a>00827             }
<a name="l00828"></a>00828             <span class="keywordflow">break</span>;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830         <span class="comment">// unserialize an array</span>
<a name="l00831"></a>00831         <span class="keywordflow">case</span> <span class="stringliteral">&#39;array&#39;</span>:
<a name="l00832"></a>00832             <span class="keywordflow">if</span> (trim($data) !== <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00833"></a>00833                 <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;guessType&#39;</span>] === <span class="keyword">true</span>) {
<a name="l00834"></a>00834                     $data = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">_guessAndSetType</a>($data);
<a name="l00835"></a>00835                 }
<a name="l00836"></a>00836                 $value[<span class="stringliteral">&#39;children&#39;</span>][$this-&gt;
<a name="l00837"></a>00837                     options[XML_UNSERIALIZER_OPTION_CONTENT_KEY]] = $data;
<a name="l00838"></a>00838             }
<a name="l00839"></a>00839             <span class="keywordflow">if</span> (isset($value[<span class="stringliteral">&#39;children&#39;</span>])) {
<a name="l00840"></a>00840                 $value[<span class="stringliteral">&#39;value&#39;</span>] = $value[<span class="stringliteral">&#39;children&#39;</span>];
<a name="l00841"></a>00841             } <span class="keywordflow">else</span> {
<a name="l00842"></a>00842                 $value[<span class="stringliteral">&#39;value&#39;</span>] = array();
<a name="l00843"></a>00843             }
<a name="l00844"></a>00844             <span class="keywordflow">break</span>;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846         <span class="comment">// unserialize a null value</span>
<a name="l00847"></a>00847         <span class="keywordflow">case</span> <span class="stringliteral">&#39;null&#39;</span>:
<a name="l00848"></a>00848             $data = null;
<a name="l00849"></a>00849             <span class="keywordflow">break</span>;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851         <span class="comment">// unserialize a resource =&gt; this is not possible :-(</span>
<a name="l00852"></a>00852         <span class="keywordflow">case</span> <span class="stringliteral">&#39;resource&#39;</span>:
<a name="l00853"></a>00853             $value[<span class="stringliteral">&#39;value&#39;</span>] = $data;
<a name="l00854"></a>00854             <span class="keywordflow">break</span>;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856         <span class="comment">// unserialize any scalar value</span>
<a name="l00857"></a>00857         <span class="keywordflow">default</span>:
<a name="l00858"></a>00858             <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;guessType&#39;</span>] === <span class="keyword">true</span>) {
<a name="l00859"></a>00859                 $data = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a73610dac293d0da9c819cd5166a88053">_guessAndSetType</a>($data);
<a name="l00860"></a>00860             } <span class="keywordflow">else</span> {
<a name="l00861"></a>00861                 settype($data, $value[<span class="stringliteral">&#39;type&#39;</span>]);
<a name="l00862"></a>00862             }
<a name="l00863"></a>00863 
<a name="l00864"></a>00864             $value[<span class="stringliteral">&#39;value&#39;</span>] = $data;
<a name="l00865"></a>00865             <span class="keywordflow">break</span>;
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867         $parent = array_pop($this-&gt;_valStack);
<a name="l00868"></a>00868         <span class="keywordflow">if</span> ($parent === null) {
<a name="l00869"></a>00869             $this-&gt;_unserializedData = &amp;$value[<span class="stringliteral">&#39;value&#39;</span>];
<a name="l00870"></a>00870             $this-&gt;_root             = &amp;$value[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l00871"></a>00871             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00872"></a>00872         } <span class="keywordflow">else</span> {
<a name="l00873"></a>00873             <span class="comment">// parent has to be an array</span>
<a name="l00874"></a>00874             <span class="keywordflow">if</span> (!isset($parent[<span class="stringliteral">&#39;children&#39;</span>]) || !is_array($parent[<span class="stringliteral">&#39;children&#39;</span>])) {
<a name="l00875"></a>00875                 $parent[<span class="stringliteral">&#39;children&#39;</span>] = array();
<a name="l00876"></a>00876                 <span class="keywordflow">if</span> (!in_array($parent[<span class="stringliteral">&#39;type&#39;</span>], array(<span class="stringliteral">&#39;array&#39;</span>, <span class="stringliteral">&#39;object&#39;</span>))) {
<a name="l00877"></a>00877                     $parent[<span class="stringliteral">&#39;type&#39;</span>] = $this-&gt;<a class="code" href="class_x_m_l___unserializer.html#a772a613a5bd0f01f4cc851f5cafa33f8">_getComplexType</a>($parent[<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00878"></a>00878                     <span class="keywordflow">if</span> ($parent[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;object&#39;</span>) {
<a name="l00879"></a>00879                         $parent[<span class="stringliteral">&#39;class&#39;</span>] = $parent[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l00880"></a>00880                     }
<a name="l00881"></a>00881                 }
<a name="l00882"></a>00882             }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884             <span class="keywordflow">if</span> (in_array($element,
<a name="l00885"></a>00885                 $this-&gt;options[<a class="code" href="_unserializer_8php.html#a0eacaec261065e76ebff33dd73aa60cb">XML_UNSERIALIZER_OPTION_IGNORE_KEYS</a>])
<a name="l00886"></a>00886             ) {
<a name="l00887"></a>00887                 $ignoreKey = <span class="keyword">true</span>;
<a name="l00888"></a>00888             } <span class="keywordflow">else</span> {
<a name="l00889"></a>00889                 $ignoreKey = <span class="keyword">false</span>;
<a name="l00890"></a>00890             }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892             <span class="keywordflow">if</span> (!empty($value[<span class="stringliteral">&#39;name&#39;</span>]) &amp;&amp; $ignoreKey === <span class="keyword">false</span>) {
<a name="l00893"></a>00893                 <span class="comment">// there already has been a tag with this name</span>
<a name="l00894"></a>00894                 <span class="keywordflow">if</span> (in_array($value[<span class="stringliteral">&#39;name&#39;</span>], $parent[<span class="stringliteral">&#39;childrenKeys&#39;</span>])
<a name="l00895"></a>00895                     || in_array($value[<span class="stringliteral">&#39;name&#39;</span>],
<a name="l00896"></a>00896                     $this-&gt;options[<a class="code" href="_unserializer_8php.html#a9760129e0d8120c4b6870632cd1706d7">XML_UNSERIALIZER_OPTION_FORCE_ENUM</a>])
<a name="l00897"></a>00897                 ) {
<a name="l00898"></a>00898                     <span class="comment">// no aggregate has been created for this tag</span>
<a name="l00899"></a>00899                     <span class="keywordflow">if</span> (!in_array($value[<span class="stringliteral">&#39;name&#39;</span>], $parent[<span class="stringliteral">&#39;aggregKeys&#39;</span>])) {
<a name="l00900"></a>00900                         <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]])) {
<a name="l00901"></a>00901                             $parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]] =
<a name="l00902"></a>00902                                 array($parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]]);
<a name="l00903"></a>00903                         } <span class="keywordflow">else</span> {
<a name="l00904"></a>00904                             $parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]] = array();
<a name="l00905"></a>00905                         }
<a name="l00906"></a>00906                         array_push($parent[<span class="stringliteral">&#39;aggregKeys&#39;</span>], $value[<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00907"></a>00907                     }
<a name="l00908"></a>00908                     array_push($parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]], $value[<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l00909"></a>00909                 } <span class="keywordflow">else</span> {
<a name="l00910"></a>00910                     $parent[<span class="stringliteral">&#39;children&#39;</span>][$value[<span class="stringliteral">&#39;name&#39;</span>]] = &amp;$value[<span class="stringliteral">&#39;value&#39;</span>];
<a name="l00911"></a>00911                     array_push($parent[<span class="stringliteral">&#39;childrenKeys&#39;</span>], $value[<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00912"></a>00912                 }
<a name="l00913"></a>00913             } <span class="keywordflow">else</span> {
<a name="l00914"></a>00914                 array_push($parent[<span class="stringliteral">&#39;children&#39;</span>], $value[<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l00915"></a>00915             }
<a name="l00916"></a>00916             array_push($this-&gt;_valStack, $parent);
<a name="l00917"></a>00917         }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919         $this-&gt;_depth--;
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921 
<a name="l00931"></a><a class="code" href="class_x_m_l___unserializer.html#a8a72db6c78840fd3ae4acb80b31492db">00931</a>     function <a class="code" href="class_x_m_l___unserializer.html#a8a72db6c78840fd3ae4acb80b31492db">cdataHandler</a>($parser, $cdata)
<a name="l00932"></a>00932     {
<a name="l00933"></a>00933         <span class="keywordflow">if</span> ($this-&gt;options[<a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a>] !== null) {
<a name="l00934"></a>00934             $cdata = call_user_func($this-&gt;
<a name="l00935"></a>00935                 options[<a class="code" href="_unserializer_8php.html#a0775beb37515203d6cdff85ca21ce581">XML_UNSERIALIZER_OPTION_DECODE_FUNC</a>], $cdata);
<a name="l00936"></a>00936         }
<a name="l00937"></a>00937         $this-&gt;_dataStack[$this-&gt;_depth] .= $cdata;
<a name="l00938"></a>00938     }
<a name="l00939"></a>00939 
<a name="l00948"></a><a class="code" href="class_x_m_l___unserializer.html#a772a613a5bd0f01f4cc851f5cafa33f8">00948</a>     function <a class="code" href="class_x_m_l___unserializer.html#a772a613a5bd0f01f4cc851f5cafa33f8">_getComplexType</a>($tagname)
<a name="l00949"></a>00949     {
<a name="l00950"></a>00950         <span class="keywordflow">if</span> (is_string($this-&gt;options[<a class="code" href="_unserializer_8php.html#a585a77c9cbf34ee4a8de3c24261775aa">XML_UNSERIALIZER_OPTION_COMPLEXTYPE</a>])) {
<a name="l00951"></a>00951             <span class="keywordflow">return</span> $this-&gt;options[XML_UNSERIALIZER_OPTION_COMPLEXTYPE];
<a name="l00952"></a>00952         }
<a name="l00953"></a>00953         <span class="keywordflow">if</span> (isset($this-&gt;options[XML_UNSERIALIZER_OPTION_COMPLEXTYPE][$tagname])) {
<a name="l00954"></a>00954             <span class="keywordflow">return</span> $this-&gt;options[XML_UNSERIALIZER_OPTION_COMPLEXTYPE][$tagname];
<a name="l00955"></a>00955         }
<a name="l00956"></a>00956         <span class="keywordflow">if</span> (isset($this-&gt;options[XML_UNSERIALIZER_OPTION_COMPLEXTYPE][<span class="stringliteral">&#39;#default&#39;</span>])) {
<a name="l00957"></a>00957             <span class="keywordflow">return</span> $this-&gt;options[XML_UNSERIALIZER_OPTION_COMPLEXTYPE][<span class="stringliteral">&#39;#default&#39;</span>];
<a name="l00958"></a>00958         }
<a name="l00959"></a>00959         <span class="keywordflow">return</span> <span class="stringliteral">&#39;array&#39;</span>;
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961 
<a name="l00968"></a><a class="code" href="class_x_m_l___unserializer.html#a3be6808013e69bdceebe258c94575859">00968</a>     function <a class="code" href="class_x_m_l___unserializer.html#a3be6808013e69bdceebe258c94575859">_createParser</a>()
<a name="l00969"></a>00969     {
<a name="l00970"></a>00970         <span class="keywordflow">if</span> (is_object($this-&gt;_parser)) {
<a name="l00971"></a>00971             $this-&gt;_parser-&gt;free();
<a name="l00972"></a>00972             unset($this-&gt;_parser);
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974         $this-&gt;_parser = &amp;<span class="keyword">new</span> XML_Parser($this-&gt;
<a name="l00975"></a>00975             options[<a class="code" href="_unserializer_8php.html#a0e18136f9d4e0d217b9acbd913fbbdb9">XML_UNSERIALIZER_OPTION_ENCODING_SOURCE</a>],
<a name="l00976"></a>00976             <span class="stringliteral">&#39;event&#39;</span>, $this-&gt;options[<a class="code" href="_unserializer_8php.html#a13462e0e1e307ac62cde11f8c6e89238">XML_UNSERIALIZER_OPTION_ENCODING_TARGET</a>]);
<a name="l00977"></a>00977 
<a name="l00978"></a>00978         $this-&gt;_parser-&gt;folding = <span class="keyword">false</span>;
<a name="l00979"></a>00979         $this-&gt;_parser-&gt;setHandlerObj($this);
<a name="l00980"></a>00980         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00981"></a>00981     }
<a name="l00982"></a>00982 }
<a name="l00983"></a>00983 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Jul 7 2010 16:02:41 for zimbraControl by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
